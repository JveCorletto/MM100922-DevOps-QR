"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/surveys/[id]/analytics/route";
exports.ids = ["app/api/surveys/[id]/analytics/route"];
exports.modules = {

/***/ "../../client/components/action-async-storage.external":
/*!*******************************************************************************!*\
  !*** external "next/dist/client/components/action-async-storage.external.js" ***!
  \*******************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/client/components/action-async-storage.external.js");

/***/ }),

/***/ "../../client/components/request-async-storage.external":
/*!********************************************************************************!*\
  !*** external "next/dist/client/components/request-async-storage.external.js" ***!
  \********************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/client/components/request-async-storage.external.js");

/***/ }),

/***/ "../../client/components/static-generation-async-storage.external":
/*!******************************************************************************************!*\
  !*** external "next/dist/client/components/static-generation-async-storage.external.js" ***!
  \******************************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/client/components/static-generation-async-storage.external.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-page.runtime.dev.js":
/*!*************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-page.runtime.dev.js" ***!
  \*************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-page.runtime.dev.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "buffer":
/*!*************************!*\
  !*** external "buffer" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("buffer");

/***/ }),

/***/ "crypto":
/*!*************************!*\
  !*** external "crypto" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("crypto");

/***/ }),

/***/ "events":
/*!*************************!*\
  !*** external "events" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("events");

/***/ }),

/***/ "http":
/*!***********************!*\
  !*** external "http" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("http");

/***/ }),

/***/ "https":
/*!************************!*\
  !*** external "https" ***!
  \************************/
/***/ ((module) => {

module.exports = require("https");

/***/ }),

/***/ "net":
/*!**********************!*\
  !*** external "net" ***!
  \**********************/
/***/ ((module) => {

module.exports = require("net");

/***/ }),

/***/ "punycode":
/*!***************************!*\
  !*** external "punycode" ***!
  \***************************/
/***/ ((module) => {

module.exports = require("punycode");

/***/ }),

/***/ "stream":
/*!*************************!*\
  !*** external "stream" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("stream");

/***/ }),

/***/ "tls":
/*!**********************!*\
  !*** external "tls" ***!
  \**********************/
/***/ ((module) => {

module.exports = require("tls");

/***/ }),

/***/ "url":
/*!**********************!*\
  !*** external "url" ***!
  \**********************/
/***/ ((module) => {

module.exports = require("url");

/***/ }),

/***/ "zlib":
/*!***********************!*\
  !*** external "zlib" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("zlib");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fsurveys%2F%5Bid%5D%2Fanalytics%2Froute&page=%2Fapi%2Fsurveys%2F%5Bid%5D%2Fanalytics%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fsurveys%2F%5Bid%5D%2Fanalytics%2Froute.ts&appDir=C%3A%5CProjects%5CMM100922-DevOps-QR%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CProjects%5CMM100922-DevOps-QR&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!**********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fsurveys%2F%5Bid%5D%2Fanalytics%2Froute&page=%2Fapi%2Fsurveys%2F%5Bid%5D%2Fanalytics%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fsurveys%2F%5Bid%5D%2Fanalytics%2Froute.ts&appDir=C%3A%5CProjects%5CMM100922-DevOps-QR%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CProjects%5CMM100922-DevOps-QR&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \**********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var C_Projects_MM100922_DevOps_QR_app_api_surveys_id_analytics_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./app/api/surveys/[id]/analytics/route.ts */ \"(rsc)/./app/api/surveys/[id]/analytics/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/surveys/[id]/analytics/route\",\n        pathname: \"/api/surveys/[id]/analytics\",\n        filename: \"route\",\n        bundlePath: \"app/api/surveys/[id]/analytics/route\"\n    },\n    resolvedPagePath: \"C:\\\\Projects\\\\MM100922-DevOps-QR\\\\app\\\\api\\\\surveys\\\\[id]\\\\analytics\\\\route.ts\",\n    nextConfigOutput,\n    userland: C_Projects_MM100922_DevOps_QR_app_api_surveys_id_analytics_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks } = routeModule;\nconst originalPathname = \"/api/surveys/[id]/analytics/route\";\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        serverHooks,\n        staticGenerationAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIuanM/bmFtZT1hcHAlMkZhcGklMkZzdXJ2ZXlzJTJGJTVCaWQlNUQlMkZhbmFseXRpY3MlMkZyb3V0ZSZwYWdlPSUyRmFwaSUyRnN1cnZleXMlMkYlNUJpZCU1RCUyRmFuYWx5dGljcyUyRnJvdXRlJmFwcFBhdGhzPSZwYWdlUGF0aD1wcml2YXRlLW5leHQtYXBwLWRpciUyRmFwaSUyRnN1cnZleXMlMkYlNUJpZCU1RCUyRmFuYWx5dGljcyUyRnJvdXRlLnRzJmFwcERpcj1DJTNBJTVDUHJvamVjdHMlNUNNTTEwMDkyMi1EZXZPcHMtUVIlNUNhcHAmcGFnZUV4dGVuc2lvbnM9dHN4JnBhZ2VFeHRlbnNpb25zPXRzJnBhZ2VFeHRlbnNpb25zPWpzeCZwYWdlRXh0ZW5zaW9ucz1qcyZyb290RGlyPUMlM0ElNUNQcm9qZWN0cyU1Q01NMTAwOTIyLURldk9wcy1RUiZpc0Rldj10cnVlJnRzY29uZmlnUGF0aD10c2NvbmZpZy5qc29uJmJhc2VQYXRoPSZhc3NldFByZWZpeD0mbmV4dENvbmZpZ091dHB1dD0mcHJlZmVycmVkUmVnaW9uPSZtaWRkbGV3YXJlQ29uZmlnPWUzMCUzRCEiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7O0FBQXNHO0FBQ3ZDO0FBQ2M7QUFDOEI7QUFDM0c7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLGdIQUFtQjtBQUMzQztBQUNBLGNBQWMseUVBQVM7QUFDdkI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLFlBQVk7QUFDWixDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0EsUUFBUSxpRUFBaUU7QUFDekU7QUFDQTtBQUNBLFdBQVcsNEVBQVc7QUFDdEI7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUN1SDs7QUFFdkgiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9lbmN1ZXN0YXMtcXIvPzA4MTAiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQXBwUm91dGVSb3V0ZU1vZHVsZSB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2Z1dHVyZS9yb3V0ZS1tb2R1bGVzL2FwcC1yb3V0ZS9tb2R1bGUuY29tcGlsZWRcIjtcbmltcG9ydCB7IFJvdXRlS2luZCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2Z1dHVyZS9yb3V0ZS1raW5kXCI7XG5pbXBvcnQgeyBwYXRjaEZldGNoIGFzIF9wYXRjaEZldGNoIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvbGliL3BhdGNoLWZldGNoXCI7XG5pbXBvcnQgKiBhcyB1c2VybGFuZCBmcm9tIFwiQzpcXFxcUHJvamVjdHNcXFxcTU0xMDA5MjItRGV2T3BzLVFSXFxcXGFwcFxcXFxhcGlcXFxcc3VydmV5c1xcXFxbaWRdXFxcXGFuYWx5dGljc1xcXFxyb3V0ZS50c1wiO1xuLy8gV2UgaW5qZWN0IHRoZSBuZXh0Q29uZmlnT3V0cHV0IGhlcmUgc28gdGhhdCB3ZSBjYW4gdXNlIHRoZW0gaW4gdGhlIHJvdXRlXG4vLyBtb2R1bGUuXG5jb25zdCBuZXh0Q29uZmlnT3V0cHV0ID0gXCJcIlxuY29uc3Qgcm91dGVNb2R1bGUgPSBuZXcgQXBwUm91dGVSb3V0ZU1vZHVsZSh7XG4gICAgZGVmaW5pdGlvbjoge1xuICAgICAgICBraW5kOiBSb3V0ZUtpbmQuQVBQX1JPVVRFLFxuICAgICAgICBwYWdlOiBcIi9hcGkvc3VydmV5cy9baWRdL2FuYWx5dGljcy9yb3V0ZVwiLFxuICAgICAgICBwYXRobmFtZTogXCIvYXBpL3N1cnZleXMvW2lkXS9hbmFseXRpY3NcIixcbiAgICAgICAgZmlsZW5hbWU6IFwicm91dGVcIixcbiAgICAgICAgYnVuZGxlUGF0aDogXCJhcHAvYXBpL3N1cnZleXMvW2lkXS9hbmFseXRpY3Mvcm91dGVcIlxuICAgIH0sXG4gICAgcmVzb2x2ZWRQYWdlUGF0aDogXCJDOlxcXFxQcm9qZWN0c1xcXFxNTTEwMDkyMi1EZXZPcHMtUVJcXFxcYXBwXFxcXGFwaVxcXFxzdXJ2ZXlzXFxcXFtpZF1cXFxcYW5hbHl0aWNzXFxcXHJvdXRlLnRzXCIsXG4gICAgbmV4dENvbmZpZ091dHB1dCxcbiAgICB1c2VybGFuZFxufSk7XG4vLyBQdWxsIG91dCB0aGUgZXhwb3J0cyB0aGF0IHdlIG5lZWQgdG8gZXhwb3NlIGZyb20gdGhlIG1vZHVsZS4gVGhpcyBzaG91bGRcbi8vIGJlIGVsaW1pbmF0ZWQgd2hlbiB3ZSd2ZSBtb3ZlZCB0aGUgb3RoZXIgcm91dGVzIHRvIHRoZSBuZXcgZm9ybWF0LiBUaGVzZVxuLy8gYXJlIHVzZWQgdG8gaG9vayBpbnRvIHRoZSByb3V0ZS5cbmNvbnN0IHsgcmVxdWVzdEFzeW5jU3RvcmFnZSwgc3RhdGljR2VuZXJhdGlvbkFzeW5jU3RvcmFnZSwgc2VydmVySG9va3MgfSA9IHJvdXRlTW9kdWxlO1xuY29uc3Qgb3JpZ2luYWxQYXRobmFtZSA9IFwiL2FwaS9zdXJ2ZXlzL1tpZF0vYW5hbHl0aWNzL3JvdXRlXCI7XG5mdW5jdGlvbiBwYXRjaEZldGNoKCkge1xuICAgIHJldHVybiBfcGF0Y2hGZXRjaCh7XG4gICAgICAgIHNlcnZlckhvb2tzLFxuICAgICAgICBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlXG4gICAgfSk7XG59XG5leHBvcnQgeyByb3V0ZU1vZHVsZSwgcmVxdWVzdEFzeW5jU3RvcmFnZSwgc3RhdGljR2VuZXJhdGlvbkFzeW5jU3RvcmFnZSwgc2VydmVySG9va3MsIG9yaWdpbmFsUGF0aG5hbWUsIHBhdGNoRmV0Y2gsICB9O1xuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1hcHAtcm91dGUuanMubWFwIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fsurveys%2F%5Bid%5D%2Fanalytics%2Froute&page=%2Fapi%2Fsurveys%2F%5Bid%5D%2Fanalytics%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fsurveys%2F%5Bid%5D%2Fanalytics%2Froute.ts&appDir=C%3A%5CProjects%5CMM100922-DevOps-QR%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CProjects%5CMM100922-DevOps-QR&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./app/api/surveys/[id]/analytics/route.ts":
/*!*************************************************!*\
  !*** ./app/api/surveys/[id]/analytics/route.ts ***!
  \*************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   GET: () => (/* binding */ GET)\n/* harmony export */ });\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(rsc)/./node_modules/next/dist/api/server.js\");\n/* harmony import */ var _lib_supabaseServer__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/lib/supabaseServer */ \"(rsc)/./lib/supabaseServer.ts\");\n// /app/api/surveys/[id]/analytics/route.ts\n\n\nasync function GET(request, { params }) {\n    try {\n        // 1. Crear cliente de Supabase con cookies SSR\n        const supabase = (0,_lib_supabaseServer__WEBPACK_IMPORTED_MODULE_1__.supabaseServer)();\n        // 2. Verificar autenticación\n        const { data: { user }, error: authError } = await supabase.auth.getUser();\n        if (!user || authError) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: \"No autorizado\"\n            }, {\n                status: 401\n            });\n        }\n        // 3. Verificar que el usuario es dueño de la encuesta\n        const { data: survey, error: surveyError } = await supabase.from(\"surveys\").select(`\r\n        *,\r\n        profiles!surveys_owner_id_fkey (id, display_name)\r\n      `).eq(\"id\", params.id).eq(\"owner_id\", user.id).single();\n        if (surveyError || !survey) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: \"Encuesta no encontrada o no autorizado\"\n            }, {\n                status: 404\n            });\n        }\n        // 4. Obtener estadísticas básicas\n        const { count: totalResponses, error: countError } = await supabase.from(\"responses\").select(\"id\", {\n            count: \"exact\",\n            head: true\n        }).eq(\"survey_id\", params.id);\n        if (countError) {\n            console.error(\"Error counting responses:\", countError);\n        }\n        // 5. Obtener preguntas con sus opciones\n        const { data: questions, error: questionsError } = await supabase.from(\"survey_questions\").select(`\r\n        *,\r\n        survey_options (\r\n          id,\r\n          label,\r\n          value,\r\n          position\r\n        )\r\n      `).eq(\"survey_id\", params.id).order(\"position\", {\n            ascending: true\n        });\n        if (questionsError) {\n            console.error(\"Error fetching questions:\", questionsError);\n        }\n        // 6. Obtener respuestas con metadatos\n        const { data: responses, error: responsesError } = await supabase.from(\"responses\").select(`\r\n        id,\r\n        submitted_at,\r\n        meta,\r\n        response_items (\r\n          question_id,\r\n          value_text,\r\n          value_numeric,\r\n          value_json\r\n        )\r\n      `).eq(\"survey_id\", params.id).order(\"submitted_at\", {\n            ascending: false\n        });\n        if (responsesError) {\n            console.error(\"Error fetching responses:\", responsesError);\n        }\n        // 7. Procesar datos para cada pregunta\n        const questionsWithAnalytics = await processQuestionsAnalytics(questions || [], responses || []);\n        // 8. Calcular estadísticas de dispositivo\n        const deviceStats = calculateDeviceStats(responses || []);\n        // 9. Calcular tasa de respuesta diaria (últimos 7 días)\n        const responseTrend = await calculateResponseTrend(supabase, params.id);\n        // 10. Preparar respuesta\n        const result = {\n            success: true,\n            data: {\n                survey: {\n                    id: survey.id,\n                    title: survey.title,\n                    status: survey.status,\n                    description: survey.description,\n                    created_at: survey.created_at,\n                    published_at: survey.publish_at,\n                    total_responses: totalResponses || 0\n                },\n                summary: {\n                    total_responses: totalResponses || 0,\n                    completion_rate: calculateCompletionRate(questions?.length || 0, responses || []),\n                    avg_response_time: calculateAverageResponseTime(responses || []),\n                    device_stats: deviceStats,\n                    response_trend: responseTrend\n                },\n                questions: questionsWithAnalytics,\n                raw_responses_count: responses?.length || 0\n            }\n        };\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json(result);\n    } catch (error) {\n        console.error(\"Error en analytics endpoint:\", error);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: \"Error interno del servidor\",\n            details: error instanceof Error ? error.message : \"Unknown error\"\n        }, {\n            status: 500\n        });\n    }\n}\n// Helper functions (las mismas que antes, pero con tipos mejorados)\nasync function processQuestionsAnalytics(questions, responses) {\n    // Procesar cada pregunta\n    return Promise.all(questions.map(async (question)=>{\n        // Filtrar respuestas para esta pregunta\n        const questionResponses = responses.flatMap((r)=>r.response_items?.filter((ri)=>ri.question_id === question.id) || []);\n        let analyticsData;\n        switch(question.type){\n            case \"single\":\n                analyticsData = processSingleChoiceAnalytics(question, questionResponses);\n                break;\n            case \"multiple\":\n                analyticsData = processMultipleChoiceAnalytics(question, questionResponses);\n                break;\n            case \"likert\":\n                analyticsData = processLikertAnalytics(question, questionResponses);\n                break;\n            case \"text\":\n                analyticsData = processTextAnalytics(questionResponses);\n                break;\n            default:\n                analyticsData = {\n                    type: question.type,\n                    unsupported: true\n                };\n        }\n        return {\n            id: question.id,\n            question_text: question.question_text,\n            type: question.type,\n            required: question.required,\n            position: question.position,\n            response_count: questionResponses.length,\n            analytics: analyticsData,\n            options: question.survey_options || []\n        };\n    }));\n}\nfunction processSingleChoiceAnalytics(question, responses) {\n    const optionCounts = {};\n    // Inicializar con opciones definidas\n    if (question.survey_options && question.survey_options.length > 0) {\n        question.survey_options.forEach((opt)=>{\n            optionCounts[opt.label || opt.value || \"\"] = 0;\n        });\n    }\n    // Contar respuestas\n    responses.forEach((response)=>{\n        if (response.value_text) {\n            const value = response.value_text;\n            optionCounts[value] = (optionCounts[value] || 0) + 1;\n        }\n    });\n    const total = responses.length;\n    const chartData = Object.entries(optionCounts).map(([option, count])=>({\n            option,\n            count,\n            percentage: total > 0 ? parseFloat((count / total * 100).toFixed(1)) : 0\n        }));\n    return {\n        chart_data: chartData,\n        total_responses: total,\n        most_selected: chartData.length > 0 ? chartData.reduce((max, item)=>item.count > max.count ? item : max) : null\n    };\n}\nfunction processMultipleChoiceAnalytics(question, responses) {\n    const optionCounts = {};\n    let totalSelections = 0;\n    // Inicializar con opciones definidas\n    if (question.survey_options && question.survey_options.length > 0) {\n        question.survey_options.forEach((opt)=>{\n            optionCounts[opt.label || opt.value || \"\"] = 0;\n        });\n    }\n    // Contar selecciones (pueden ser múltiples por respuesta)\n    responses.forEach((response)=>{\n        if (response.value_json && Array.isArray(response.value_json)) {\n            response.value_json.forEach((value)=>{\n                if (optionCounts[value] !== undefined) {\n                    optionCounts[value]++;\n                    totalSelections++;\n                }\n            });\n        }\n    });\n    const totalResponses = responses.length;\n    const chartData = Object.entries(optionCounts).map(([option, count])=>({\n            option,\n            count,\n            selection_percentage: totalSelections > 0 ? parseFloat((count / totalSelections * 100).toFixed(1)) : 0,\n            respondent_percentage: totalResponses > 0 ? parseFloat((count / totalResponses * 100).toFixed(1)) : 0\n        }));\n    return {\n        chart_data: chartData,\n        total_responses: totalResponses,\n        total_selections: totalSelections,\n        avg_selections_per_response: totalResponses > 0 ? parseFloat((totalSelections / totalResponses).toFixed(2)) : 0,\n        most_selected: chartData.length > 0 ? chartData.reduce((max, item)=>item.count > max.count ? item : max) : null\n    };\n}\nfunction processLikertAnalytics(question, responses) {\n    const ratingCounts = {};\n    const ratings = [\n        1,\n        2,\n        3,\n        4,\n        5,\n        6,\n        7\n    ]; // Escala común\n    // Inicializar contadores\n    ratings.forEach((rating)=>{\n        ratingCounts[rating] = 0;\n    });\n    // Contar respuestas\n    let total = 0;\n    let sum = 0;\n    responses.forEach((response)=>{\n        if (response.value_numeric !== null && response.value_numeric !== undefined) {\n            const rating = Number(response.value_numeric);\n            if (ratings.includes(rating)) {\n                ratingCounts[rating]++;\n                total++;\n                sum += rating;\n            }\n        }\n    });\n    const chartData = Object.entries(ratingCounts).map(([rating, count])=>({\n            rating: Number(rating),\n            count,\n            percentage: total > 0 ? parseFloat((count / total * 100).toFixed(1)) : 0\n        }));\n    return {\n        chart_data: chartData,\n        total_responses: total,\n        average_rating: total > 0 ? parseFloat((sum / total).toFixed(2)) : 0,\n        median_rating: calculateMedian(responses),\n        distribution: chartData\n    };\n}\nfunction processTextAnalytics(responses) {\n    const textResponses = responses.filter((r)=>r.value_text && r.value_text.trim().length > 0).map((r)=>({\n            text: r.value_text,\n            length: r.value_text.length,\n            word_count: r.value_text.split(/\\s+/).filter((w)=>w.length > 0).length\n        }));\n    // Análisis básico de texto\n    const wordFrequencies = analyzeWordFrequency(textResponses.map((r)=>r.text));\n    const avgLength = textResponses.length > 0 ? textResponses.reduce((sum, r)=>sum + r.length, 0) / textResponses.length : 0;\n    const avgWordCount = textResponses.length > 0 ? textResponses.reduce((sum, r)=>sum + r.word_count, 0) / textResponses.length : 0;\n    return {\n        total_responses: textResponses.length,\n        sample_responses: textResponses.slice(0, 10),\n        word_frequencies: wordFrequencies.slice(0, 20),\n        average_length: Math.round(avgLength),\n        average_word_count: Math.round(avgWordCount),\n        shortest_response: textResponses.length > 0 ? textResponses.reduce((min, r)=>r.length < min.length ? r : min, textResponses[0]) : null,\n        longest_response: textResponses.length > 0 ? textResponses.reduce((max, r)=>r.length > max.length ? r : max, textResponses[0]) : null\n    };\n}\nfunction calculateDeviceStats(responses) {\n    const stats = {\n        mobile: 0,\n        desktop: 0,\n        tablet: 0,\n        browsers: {},\n        operating_systems: {},\n        total: responses.length\n    };\n    responses.forEach((response)=>{\n        const meta = response.meta || {};\n        // Detectar dispositivo\n        if (meta.is_mobile) {\n            stats.mobile++;\n        } else if (meta.is_tablet) {\n            stats.tablet++;\n        } else {\n            stats.desktop++;\n        }\n        // Navegador\n        if (meta.browser) {\n            const browser = meta.browser.split(\" \")[0]; // Tomar solo el nombre principal\n            stats.browsers[browser] = (stats.browsers[browser] || 0) + 1;\n        }\n        // Sistema operativo\n        if (meta.os) {\n            stats.operating_systems[meta.os] = (stats.operating_systems[meta.os] || 0) + 1;\n        }\n    });\n    const total = stats.total || 1; // Evitar división por 0\n    return {\n        ...stats,\n        mobile_percentage: total > 0 ? parseFloat((stats.mobile / total * 100).toFixed(1)) : 0,\n        desktop_percentage: total > 0 ? parseFloat((stats.desktop / total * 100).toFixed(1)) : 0,\n        tablet_percentage: total > 0 ? parseFloat((stats.tablet / total * 100).toFixed(1)) : 0,\n        top_browser: Object.entries(stats.browsers).sort((a, b)=>b[1] - a[1])[0]?.[0] || \"Desconocido\",\n        top_os: Object.entries(stats.operating_systems).sort((a, b)=>b[1] - a[1])[0]?.[0] || \"Desconocido\"\n    };\n}\nasync function calculateResponseTrend(supabase, surveyId) {\n    const sevenDaysAgo = new Date();\n    sevenDaysAgo.setDate(sevenDaysAgo.getDate() - 7);\n    const { data: dailyResponses, error } = await supabase.from(\"responses\").select(\"submitted_at\").eq(\"survey_id\", surveyId).gte(\"submitted_at\", sevenDaysAgo.toISOString()).order(\"submitted_at\", {\n        ascending: true\n    });\n    if (error) {\n        console.error(\"Error fetching response trend:\", error);\n        return [];\n    }\n    // Agrupar por día\n    const dailyCounts = {};\n    dailyResponses?.forEach((response)=>{\n        const date = new Date(response.submitted_at).toISOString().split(\"T\")[0];\n        dailyCounts[date] = (dailyCounts[date] || 0) + 1;\n    });\n    // Rellenar días sin respuestas\n    const trendData = [];\n    for(let i = 6; i >= 0; i--){\n        const date = new Date();\n        date.setDate(date.getDate() - i);\n        const dateStr = date.toISOString().split(\"T\")[0];\n        trendData.push({\n            date: dateStr,\n            count: dailyCounts[dateStr] || 0\n        });\n    }\n    return trendData;\n}\nfunction calculateCompletionRate(totalQuestions, responses) {\n    if (responses.length === 0 || totalQuestions === 0) return 0;\n    let totalAnswered = 0;\n    responses.forEach((response)=>{\n        const answered = response.response_items?.length || 0;\n        totalAnswered += answered / totalQuestions;\n    });\n    return parseFloat((totalAnswered / responses.length * 100).toFixed(1));\n}\nfunction calculateAverageResponseTime(responses) {\n    // Esto asume que tienes un campo de tiempo de inicio y fin\n    // Por ahora, retornar un valor estimado basado en la cantidad de preguntas\n    if (responses.length === 0) return \"0\";\n    const estimatedTimePerQuestion = 15; // segundos por pregunta\n    const avgQuestionsAnswered = responses.reduce((sum, r)=>sum + (r.response_items?.length || 0), 0) / responses.length;\n    const avgSeconds = avgQuestionsAnswered * estimatedTimePerQuestion;\n    const minutes = Math.floor(avgSeconds / 60);\n    return minutes > 0 ? `${minutes}m` : `${Math.round(avgSeconds)}s`;\n}\nfunction calculateMedian(responses) {\n    const ratings = responses.map((r)=>r.value_numeric).filter((r)=>r !== null && r !== undefined).sort((a, b)=>a - b);\n    if (ratings.length === 0) return 0;\n    const middle = Math.floor(ratings.length / 2);\n    if (ratings.length % 2 === 0) {\n        return (ratings[middle - 1] + ratings[middle]) / 2;\n    }\n    return ratings[middle];\n}\nfunction analyzeWordFrequency(texts) {\n    const wordMap = {};\n    const stopWords = new Set([\n        \"el\",\n        \"la\",\n        \"los\",\n        \"las\",\n        \"un\",\n        \"una\",\n        \"de\",\n        \"que\",\n        \"y\",\n        \"en\",\n        \"a\",\n        \"con\"\n    ]);\n    texts.forEach((text)=>{\n        const words = text.toLowerCase().replace(/[^\\w\\sáéíóúñ]/g, \"\").split(/\\s+/).filter((word)=>word.length > 2 && !stopWords.has(word));\n        words.forEach((word)=>{\n            wordMap[word] = (wordMap[word] || 0) + 1;\n        });\n    });\n    return Object.entries(wordMap).sort((a, b)=>b[1] - a[1]).map(([word, count])=>({\n            word,\n            count\n        }));\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9hcHAvYXBpL3N1cnZleXMvW2lkXS9hbmFseXRpY3Mvcm91dGUudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQUEsMkNBQTJDO0FBQ2E7QUFDRjtBQUUvQyxlQUFlRSxJQUNwQkMsT0FBb0IsRUFDcEIsRUFBRUMsTUFBTSxFQUE4QjtJQUV0QyxJQUFJO1FBQ0YsK0NBQStDO1FBQy9DLE1BQU1DLFdBQVdKLG1FQUFjQTtRQUUvQiw2QkFBNkI7UUFDN0IsTUFBTSxFQUFFSyxNQUFNLEVBQUVDLElBQUksRUFBRSxFQUFFQyxPQUFPQyxTQUFTLEVBQUUsR0FBRyxNQUFNSixTQUFTSyxJQUFJLENBQUNDLE9BQU87UUFDeEUsSUFBSSxDQUFDSixRQUFRRSxXQUFXO1lBQ3RCLE9BQU9ULHFEQUFZQSxDQUFDWSxJQUFJLENBQUM7Z0JBQUVKLE9BQU87WUFBZ0IsR0FBRztnQkFBRUssUUFBUTtZQUFJO1FBQ3JFO1FBRUEsc0RBQXNEO1FBQ3RELE1BQU0sRUFBRVAsTUFBTVEsTUFBTSxFQUFFTixPQUFPTyxXQUFXLEVBQUUsR0FBRyxNQUFNVixTQUNoRFcsSUFBSSxDQUFDLFdBQ0xDLE1BQU0sQ0FBQyxDQUFDOzs7TUFHVCxDQUFDLEVBQ0FDLEVBQUUsQ0FBQyxNQUFNZCxPQUFPZSxFQUFFLEVBQ2xCRCxFQUFFLENBQUMsWUFBWVgsS0FBS1ksRUFBRSxFQUN0QkMsTUFBTTtRQUVULElBQUlMLGVBQWUsQ0FBQ0QsUUFBUTtZQUMxQixPQUFPZCxxREFBWUEsQ0FBQ1ksSUFBSSxDQUFDO2dCQUN2QkosT0FBTztZQUNULEdBQUc7Z0JBQUVLLFFBQVE7WUFBSTtRQUNuQjtRQUVBLGtDQUFrQztRQUNsQyxNQUFNLEVBQUVRLE9BQU9DLGNBQWMsRUFBRWQsT0FBT2UsVUFBVSxFQUFFLEdBQUcsTUFBTWxCLFNBQ3hEVyxJQUFJLENBQUMsYUFDTEMsTUFBTSxDQUFDLE1BQU07WUFBRUksT0FBTztZQUFTRyxNQUFNO1FBQUssR0FDMUNOLEVBQUUsQ0FBQyxhQUFhZCxPQUFPZSxF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QU9yRyxPQUFPQyxPQUFPLENBQUM4RixTQUNuQjdCLElBQUksQ0FBQyxDQUFDQyxHQUFHQyxJQUFNQSxDQUFDLENBQUMsRUFBRSxHQUFHRCxDQUFDLENBQUMsRUFBRSxFQUMxQm5HLEdBQUcsQ0FBQyxDQUFDLENBQUNxSSxNQUFNNUssTUFBTSxHQUFNO1lBQUU0SztZQUFNNUs7UUFBTTtBQUMzQyIsInNvdXJjZXMiOlsid2VicGFjazovL2VuY3Vlc3Rhcy1xci8uL2FwcC9hcGkvc3VydmV5cy9baWRdL2FuYWx5dGljcy9yb3V0ZS50cz82MzU0Il0sInNvdXJjZXNDb250ZW50IjpbIi8vIC9hcHAvYXBpL3N1cnZleXMvW2lkXS9hbmFseXRpY3Mvcm91dGUudHNcclxuaW1wb3J0IHsgTmV4dFJlcXVlc3QsIE5leHRSZXNwb25zZSB9IGZyb20gJ25leHQvc2VydmVyJztcclxuaW1wb3J0IHsgc3VwYWJhc2VTZXJ2ZXIgfSBmcm9tICdAL2xpYi9zdXBhYmFzZVNlcnZlcic7XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gR0VUKFxyXG4gIHJlcXVlc3Q6IE5leHRSZXF1ZXN0LFxyXG4gIHsgcGFyYW1zIH06IHsgcGFyYW1zOiB7IGlkOiBzdHJpbmcgfSB9XHJcbikge1xyXG4gIHRyeSB7XHJcbiAgICAvLyAxLiBDcmVhciBjbGllbnRlIGRlIFN1cGFiYXNlIGNvbiBjb29raWVzIFNTUlxyXG4gICAgY29uc3Qgc3VwYWJhc2UgPSBzdXBhYmFzZVNlcnZlcigpO1xyXG4gICAgXHJcbiAgICAvLyAyLiBWZXJpZmljYXIgYXV0ZW50aWNhY2nDs25cclxuICAgIGNvbnN0IHsgZGF0YTogeyB1c2VyIH0sIGVycm9yOiBhdXRoRXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlLmF1dGguZ2V0VXNlcigpO1xyXG4gICAgaWYgKCF1c2VyIHx8IGF1dGhFcnJvcikge1xyXG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBlcnJvcjogJ05vIGF1dG9yaXphZG8nIH0sIHsgc3RhdHVzOiA0MDEgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gMy4gVmVyaWZpY2FyIHF1ZSBlbCB1c3VhcmlvIGVzIGR1ZcOxbyBkZSBsYSBlbmN1ZXN0YVxyXG4gICAgY29uc3QgeyBkYXRhOiBzdXJ2ZXksIGVycm9yOiBzdXJ2ZXlFcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcclxuICAgICAgLmZyb20oJ3N1cnZleXMnKVxyXG4gICAgICAuc2VsZWN0KGBcclxuICAgICAgICAqLFxyXG4gICAgICAgIHByb2ZpbGVzIXN1cnZleXNfb3duZXJfaWRfZmtleSAoaWQsIGRpc3BsYXlfbmFtZSlcclxuICAgICAgYClcclxuICAgICAgLmVxKCdpZCcsIHBhcmFtcy5pZClcclxuICAgICAgLmVxKCdvd25lcl9pZCcsIHVzZXIuaWQpXHJcbiAgICAgIC5zaW5nbGUoKTtcclxuXHJcbiAgICBpZiAoc3VydmV5RXJyb3IgfHwgIXN1cnZleSkge1xyXG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBcclxuICAgICAgICBlcnJvcjogJ0VuY3Vlc3RhIG5vIGVuY29udHJhZGEgbyBubyBhdXRvcml6YWRvJyBcclxuICAgICAgfSwgeyBzdGF0dXM6IDQwNCB9KTtcclxuICAgIH1cclxuXHJcbiAgICAvLyA0LiBPYnRlbmVyIGVzdGFkw61zdGljYXMgYsOhc2ljYXNcclxuICAgIGNvbnN0IHsgY291bnQ6IHRvdGFsUmVzcG9uc2VzLCBlcnJvcjogY291bnRFcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcclxuICAgICAgLmZyb20oJ3Jlc3BvbnNlcycpXHJcbiAgICAgIC5zZWxlY3QoJ2lkJywgeyBjb3VudDogJ2V4YWN0JywgaGVhZDogdHJ1ZSB9KVxyXG4gICAgICAuZXEoJ3N1cnZleV9pZCcsIHBhcmFtcy5pZCk7XHJcblxyXG4gICAgaWYgKGNvdW50RXJyb3IpIHtcclxuICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgY291bnRpbmcgcmVzcG9uc2VzOicsIGNvdW50RXJyb3IpO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIDUuIE9idGVuZXIgcHJlZ3VudGFzIGNvbiBzdXMgb3BjaW9uZXNcclxuICAgIGNvbnN0IHsgZGF0YTogcXVlc3Rpb25zLCBlcnJvcjogcXVlc3Rpb25zRXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXHJcbiAgICAgIC5mcm9tKCdzdXJ2ZXlfcXVlc3Rpb25zJylcclxuICAgICAgLnNlbGVjdChgXHJcbiAgICAgICAgKixcclxuICAgICAgICBzdXJ2ZXlfb3B0aW9ucyAoXHJcbiAgICAgICAgICBpZCxcclxuICAgICAgICAgIGxhYmVsLFxyXG4gICAgICAgICAgdmFsdWUsXHJcbiAgICAgICAgICBwb3NpdGlvblxyXG4gICAgICAgIClcclxuICAgICAgYClcclxuICAgICAgLmVxKCdzdXJ2ZXlfaWQnLCBwYXJhbXMuaWQpXHJcbiAgICAgIC5vcmRlcigncG9zaXRpb24nLCB7IGFzY2VuZGluZzogdHJ1ZSB9KTtcclxuXHJcbiAgICBpZiAocXVlc3Rpb25zRXJyb3IpIHtcclxuICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgZmV0Y2hpbmcgcXVlc3Rpb25zOicsIHF1ZXN0aW9uc0Vycm9yKTtcclxuICAgIH1cclxuXHJcbiAgICAvLyA2LiBPYnRlbmVyIHJlc3B1ZXN0YXMgY29uIG1ldGFkYXRvc1xyXG4gICAgY29uc3QgeyBkYXRhOiByZXNwb25zZXMsIGVycm9yOiByZXNwb25zZXNFcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcclxuICAgICAgLmZyb20oJ3Jlc3BvbnNlcycpXHJcbiAgICAgIC5zZWxlY3QoYFxyXG4gICAgICAgIGlkLFxyXG4gICAgICAgIHN1Ym1pdHRlZF9hdCxcclxuICAgICAgICBtZXRhLFxyXG4gICAgICAgIHJlc3BvbnNlX2l0ZW1zIChcclxuICAgICAgICAgIHF1ZXN0aW9uX2lkLFxyXG4gICAgICAgICAgdmFsdWVfdGV4dCxcclxuICAgICAgICAgIHZhbHVlX251bWVyaWMsXHJcbiAgICAgICAgICB2YWx1ZV9qc29uXHJcbiAgICAgICAgKVxyXG4gICAgICBgKVxyXG4gICAgICAuZXEoJ3N1cnZleV9pZCcsIHBhcmFtcy5pZClcclxuICAgICAgLm9yZGVyKCdzdWJtaXR0ZWRfYXQnLCB7IGFzY2VuZGluZzogZmFsc2UgfSk7XHJcblxyXG4gICAgaWYgKHJlc3BvbnNlc0Vycm9yKSB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZldGNoaW5nIHJlc3BvbnNlczonLCByZXNwb25zZXNFcnJvcik7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gNy4gUHJvY2VzYXIgZGF0b3MgcGFyYSBjYWRhIHByZWd1bnRhXHJcbiAgICBjb25zdCBxdWVzdGlvbnNXaXRoQW5hbHl0aWNzID0gYXdhaXQgcHJvY2Vzc1F1ZXN0aW9uc0FuYWx5dGljcyhcclxuICAgICAgcXVlc3Rpb25zIHx8IFtdLFxyXG4gICAgICByZXNwb25zZXMgfHwgW11cclxuICAgICk7XHJcblxyXG4gICAgLy8gOC4gQ2FsY3VsYXIgZXN0YWTDrXN0aWNhcyBkZSBkaXNwb3NpdGl2b1xyXG4gICAgY29uc3QgZGV2aWNlU3RhdHMgPSBjYWxjdWxhdGVEZXZpY2VTdGF0cyhyZXNwb25zZXMgfHwgW10pO1xyXG5cclxuICAgIC8vIDkuIENhbGN1bGFyIHRhc2EgZGUgcmVzcHVlc3RhIGRpYXJpYSAow7psdGltb3MgNyBkw61hcylcclxuICAgIGNvbnN0IHJlc3BvbnNlVHJlbmQgPSBhd2FpdCBjYWxjdWxhdGVSZXNwb25zZVRyZW5kKHN1cGFiYXNlLCBwYXJhbXMuaWQpO1xyXG5cclxuICAgIC8vIDEwLiBQcmVwYXJhciByZXNwdWVzdGFcclxuICAgIGNvbnN0IHJlc3VsdCA9IHtcclxuICAgICAgc3VjY2VzczogdHJ1ZSxcclxuICAgICAgZGF0YToge1xyXG4gICAgICAgIHN1cnZleToge1xyXG4gICAgICAgICAgaWQ6IHN1cnZleS5pZCxcclxuICAgICAgICAgIHRpdGxlOiBzdXJ2ZXkudGl0bGUsXHJcbiAgICAgICAgICBzdGF0dXM6IHN1cnZleS5zdGF0dXMsXHJcbiAgICAgICAgICBkZXNjcmlwdGlvbjogc3VydmV5LmRlc2NyaXB0aW9uLFxyXG4gICAgICAgICAgY3JlYXRlZF9hdDogc3VydmV5LmNyZWF0ZWRfYXQsXHJcbiAgICAgICAgICBwdWJsaXNoZWRfYXQ6IHN1cnZleS5wdWJsaXNoX2F0LFxyXG4gICAgICAgICAgdG90YWxfcmVzcG9uc2VzOiB0b3RhbFJlc3BvbnNlcyB8fCAwXHJcbiAgICAgICAgfSxcclxuICAgICAgICBzdW1tYXJ5OiB7XHJcbiAgICAgICAgICB0b3RhbF9yZXNwb25zZXM6IHRvdGFsUmVzcG9uc2VzIHx8IDAsXHJcbiAgICAgICAgICBjb21wbGV0aW9uX3JhdGU6IGNhbGN1bGF0ZUNvbXBsZXRpb25SYXRlKHF1ZXN0aW9ucz8ubGVuZ3RoIHx8IDAsIHJlc3BvbnNlcyB8fCBbXSksXHJcbiAgICAgICAgICBhdmdfcmVzcG9uc2VfdGltZTogY2FsY3VsYXRlQXZlcmFnZVJlc3BvbnNlVGltZShyZXNwb25zZXMgfHwgW10pLFxyXG4gICAgICAgICAgZGV2aWNlX3N0YXRzOiBkZXZpY2VTdGF0cyxcclxuICAgICAgICAgIHJlc3BvbnNlX3RyZW5kOiByZXNwb25zZVRyZW5kXHJcbiAgICAgICAgfSxcclxuICAgICAgICBxdWVzdGlvbnM6IHF1ZXN0aW9uc1dpdGhBbmFseXRpY3MsXHJcbiAgICAgICAgcmF3X3Jlc3BvbnNlc19jb3VudDogcmVzcG9uc2VzPy5sZW5ndGggfHwgMFxyXG4gICAgICB9XHJcbiAgICB9O1xyXG5cclxuICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihyZXN1bHQpO1xyXG5cclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgZW4gYW5hbHl0aWNzIGVuZHBvaW50OicsIGVycm9yKTtcclxuICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IFxyXG4gICAgICBlcnJvcjogJ0Vycm9yIGludGVybm8gZGVsIHNlcnZpZG9yJyxcclxuICAgICAgZGV0YWlsczogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnVW5rbm93biBlcnJvcidcclxuICAgIH0sIHsgc3RhdHVzOiA1MDAgfSk7XHJcbiAgfVxyXG59XHJcblxyXG4vLyBIZWxwZXIgZnVuY3Rpb25zIChsYXMgbWlzbWFzIHF1ZSBhbnRlcywgcGVybyBjb24gdGlwb3MgbWVqb3JhZG9zKVxyXG5hc3luYyBmdW5jdGlvbiBwcm9jZXNzUXVlc3Rpb25zQW5hbHl0aWNzKHF1ZXN0aW9uczogYW55W10sIHJlc3BvbnNlczogYW55W10pIHtcclxuICAvLyBQcm9jZXNhciBjYWRhIHByZWd1bnRhXHJcbiAgcmV0dXJuIFByb21pc2UuYWxsKFxyXG4gICAgcXVlc3Rpb25zLm1hcChhc3luYyAocXVlc3Rpb24pID0+IHtcclxuICAgICAgLy8gRmlsdHJhciByZXNwdWVzdGFzIHBhcmEgZXN0YSBwcmVndW50YVxyXG4gICAgICBjb25zdCBxdWVzdGlvblJlc3BvbnNlcyA9IHJlc3BvbnNlcy5mbGF0TWFwKChyOiBhbnkpID0+IFxyXG4gICAgICAgIHIucmVzcG9uc2VfaXRlbXM/LmZpbHRlcigocmk6IGFueSkgPT4gcmkucXVlc3Rpb25faWQgPT09IHF1ZXN0aW9uLmlkKSB8fCBbXVxyXG4gICAgICApO1xyXG5cclxuICAgICAgbGV0IGFuYWx5dGljc0RhdGE7XHJcbiAgICAgIFxyXG4gICAgICBzd2l0Y2ggKHF1ZXN0aW9uLnR5cGUpIHtcclxuICAgICAgICBjYXNlICdzaW5nbGUnOlxyXG4gICAgICAgICAgYW5hbHl0aWNzRGF0YSA9IHByb2Nlc3NTaW5nbGVDaG9pY2VBbmFseXRpY3MocXVlc3Rpb24sIHF1ZXN0aW9uUmVzcG9uc2VzKTtcclxuICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIGNhc2UgJ211bHRpcGxlJzpcclxuICAgICAgICAgIGFuYWx5dGljc0RhdGEgPSBwcm9jZXNzTXVsdGlwbGVDaG9pY2VBbmFseXRpY3MocXVlc3Rpb24sIHF1ZXN0aW9uUmVzcG9uc2VzKTtcclxuICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIGNhc2UgJ2xpa2VydCc6XHJcbiAgICAgICAgICBhbmFseXRpY3NEYXRhID0gcHJvY2Vzc0xpa2VydEFuYWx5dGljcyhxdWVzdGlvbiwgcXVlc3Rpb25SZXNwb25zZXMpO1xyXG4gICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgY2FzZSAndGV4dCc6XHJcbiAgICAgICAgICBhbmFseXRpY3NEYXRhID0gcHJvY2Vzc1RleHRBbmFseXRpY3MocXVlc3Rpb25SZXNwb25zZXMpO1xyXG4gICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgIGFuYWx5dGljc0RhdGEgPSB7IHR5cGU6IHF1ZXN0aW9uLnR5cGUsIHVuc3VwcG9ydGVkOiB0cnVlIH07XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIHJldHVybiB7XHJcbiAgICAgICAgaWQ6IHF1ZXN0aW9uLmlkLFxyXG4gICAgICAgIHF1ZXN0aW9uX3RleHQ6IHF1ZXN0aW9uLnF1ZXN0aW9uX3RleHQsXHJcbiAgICAgICAgdHlwZTogcXVlc3Rpb24udHlwZSxcclxuICAgICAgICByZXF1aXJlZDogcXVlc3Rpb24ucmVxdWlyZWQsXHJcbiAgICAgICAgcG9zaXRpb246IHF1ZXN0aW9uLnBvc2l0aW9uLFxyXG4gICAgICAgIHJlc3BvbnNlX2NvdW50OiBxdWVzdGlvblJlc3BvbnNlcy5sZW5ndGgsXHJcbiAgICAgICAgYW5hbHl0aWNzOiBhbmFseXRpY3NEYXRhLFxyXG4gICAgICAgIG9wdGlvbnM6IHF1ZXN0aW9uLnN1cnZleV9vcHRpb25zIHx8IFtdXHJcbiAgICAgIH07XHJcbiAgICB9KVxyXG4gICk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHByb2Nlc3NTaW5nbGVDaG9pY2VBbmFseXRpY3MocXVlc3Rpb246IGFueSwgcmVzcG9uc2VzOiBhbnlbXSkge1xyXG4gIGNvbnN0IG9wdGlvbkNvdW50czogUmVjb3JkPHN0cmluZywgbnVtYmVyPiA9IHt9O1xyXG4gIFxyXG4gIC8vIEluaWNpYWxpemFyIGNvbiBvcGNpb25lcyBkZWZpbmlkYXNcclxuICBpZiAocXVlc3Rpb24uc3VydmV5X29wdGlvbnMgJiYgcXVlc3Rpb24uc3VydmV5X29wdGlvbnMubGVuZ3RoID4gMCkge1xyXG4gICAgcXVlc3Rpb24uc3VydmV5X29wdGlvbnMuZm9yRWFjaCgob3B0OiBhbnkpID0+IHtcclxuICAgICAgb3B0aW9uQ291bnRzW29wdC5sYWJlbCB8fCBvcHQudmFsdWUgfHwgJyddID0gMDtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgLy8gQ29udGFyIHJlc3B1ZXN0YXNcclxuICByZXNwb25zZXMuZm9yRWFjaChyZXNwb25zZSA9PiB7XHJcbiAgICBpZiAocmVzcG9uc2UudmFsdWVfdGV4dCkge1xyXG4gICAgICBjb25zdCB2YWx1ZSA9IHJlc3BvbnNlLnZhbHVlX3RleHQ7XHJcbiAgICAgIG9wdGlvbkNvdW50c1t2YWx1ZV0gPSAob3B0aW9uQ291bnRzW3ZhbHVlXSB8fCAwKSArIDE7XHJcbiAgICB9XHJcbiAgfSk7XHJcblxyXG4gIGNvbnN0IHRvdGFsID0gcmVzcG9uc2VzLmxlbmd0aDtcclxuICBjb25zdCBjaGFydERhdGEgPSBPYmplY3QuZW50cmllcyhvcHRpb25Db3VudHMpLm1hcCgoW29wdGlvbiwgY291bnRdKSA9PiAoe1xyXG4gICAgb3B0aW9uLFxyXG4gICAgY291bnQsXHJcbiAgICBwZXJjZW50YWdlOiB0b3RhbCA+IDAgPyBwYXJzZUZsb2F0KChjb3VudCAvIHRvdGFsICogMTAwKS50b0ZpeGVkKDEpKSA6IDBcclxuICB9KSk7XHJcblxyXG4gIHJldHVybiB7XHJcbiAgICBjaGFydF9kYXRhOiBjaGFydERhdGEsXHJcbiAgICB0b3RhbF9yZXNwb25zZXM6IHRvdGFsLFxyXG4gICAgbW9zdF9zZWxlY3RlZDogY2hhcnREYXRhLmxlbmd0aCA+IDAgXHJcbiAgICAgID8gY2hhcnREYXRhLnJlZHVjZSgobWF4LCBpdGVtKSA9PiBpdGVtLmNvdW50ID4gbWF4LmNvdW50ID8gaXRlbSA6IG1heClcclxuICAgICAgOiBudWxsXHJcbiAgfTtcclxufVxyXG5cclxuZnVuY3Rpb24gcHJvY2Vzc011bHRpcGxlQ2hvaWNlQW5hbHl0aWNzKHF1ZXN0aW9uOiBhbnksIHJlc3BvbnNlczogYW55W10pIHtcclxuICBjb25zdCBvcHRpb25Db3VudHM6IFJlY29yZDxzdHJpbmcsIG51bWJlcj4gPSB7fTtcclxuICBsZXQgdG90YWxTZWxlY3Rpb25zID0gMDtcclxuXHJcbiAgLy8gSW5pY2lhbGl6YXIgY29uIG9wY2lvbmVzIGRlZmluaWRhc1xyXG4gIGlmIChxdWVzdGlvbi5zdXJ2ZXlfb3B0aW9ucyAmJiBxdWVzdGlvbi5zdXJ2ZXlfb3B0aW9ucy5sZW5ndGggPiAwKSB7XHJcbiAgICBxdWVzdGlvbi5zdXJ2ZXlfb3B0aW9ucy5mb3JFYWNoKChvcHQ6IGFueSkgPT4ge1xyXG4gICAgICBvcHRpb25Db3VudHNbb3B0LmxhYmVsIHx8IG9wdC52YWx1ZSB8fCAnJ10gPSAwO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICAvLyBDb250YXIgc2VsZWNjaW9uZXMgKHB1ZWRlbiBzZXIgbcO6bHRpcGxlcyBwb3IgcmVzcHVlc3RhKVxyXG4gIHJlc3BvbnNlcy5mb3JFYWNoKHJlc3BvbnNlID0+IHtcclxuICAgIGlmIChyZXNwb25zZS52YWx1ZV9qc29uICYmIEFycmF5LmlzQXJyYXkocmVzcG9uc2UudmFsdWVfanNvbikpIHtcclxuICAgICAgcmVzcG9uc2UudmFsdWVfanNvbi5mb3JFYWNoKCh2YWx1ZTogc3RyaW5nKSA9PiB7XHJcbiAgICAgICAgaWYgKG9wdGlvbkNvdW50c1t2YWx1ZV0gIT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgb3B0aW9uQ291bnRzW3ZhbHVlXSsrO1xyXG4gICAgICAgICAgdG90YWxTZWxlY3Rpb25zKys7XHJcbiAgICAgICAgfVxyXG4gICAgICB9KTtcclxuICAgIH1cclxuICB9KTtcclxuXHJcbiAgY29uc3QgdG90YWxSZXNwb25zZXMgPSByZXNwb25zZXMubGVuZ3RoO1xyXG4gIGNvbnN0IGNoYXJ0RGF0YSA9IE9iamVjdC5lbnRyaWVzKG9wdGlvbkNvdW50cykubWFwKChbb3B0aW9uLCBjb3VudF0pID0+ICh7XHJcbiAgICBvcHRpb24sXHJcbiAgICBjb3VudCxcclxuICAgIHNlbGVjdGlvbl9wZXJjZW50YWdlOiB0b3RhbFNlbGVjdGlvbnMgPiAwID8gcGFyc2VGbG9hdCgoY291bnQgLyB0b3RhbFNlbGVjdGlvbnMgKiAxMDApLnRvRml4ZWQoMSkpIDogMCxcclxuICAgIHJlc3BvbmRlbnRfcGVyY2VudGFnZTogdG90YWxSZXNwb25zZXMgPiAwID8gcGFyc2VGbG9hdCgoY291bnQgLyB0b3RhbFJlc3BvbnNlcyAqIDEwMCkudG9GaXhlZCgxKSkgOiAwXHJcbiAgfSkpO1xyXG5cclxuICByZXR1cm4ge1xyXG4gICAgY2hhcnRfZGF0YTogY2hhcnREYXRhLFxyXG4gICAgdG90YWxfcmVzcG9uc2VzOiB0b3RhbFJlc3BvbnNlcyxcclxuICAgIHRvdGFsX3NlbGVjdGlvbnM6IHRvdGFsU2VsZWN0aW9ucyxcclxuICAgIGF2Z19zZWxlY3Rpb25zX3Blcl9yZXNwb25zZTogdG90YWxSZXNwb25zZXMgPiAwID8gcGFyc2VGbG9hdCgodG90YWxTZWxlY3Rpb25zIC8gdG90YWxSZXNwb25zZXMpLnRvRml4ZWQoMikpIDogMCxcclxuICAgIG1vc3Rfc2VsZWN0ZWQ6IGNoYXJ0RGF0YS5sZW5ndGggPiAwIFxyXG4gICAgICA/IGNoYXJ0RGF0YS5yZWR1Y2UoKG1heCwgaXRlbSkgPT4gaXRlbS5jb3VudCA+IG1heC5jb3VudCA/IGl0ZW0gOiBtYXgpXHJcbiAgICAgIDogbnVsbFxyXG4gIH07XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHByb2Nlc3NMaWtlcnRBbmFseXRpY3MocXVlc3Rpb246IGFueSwgcmVzcG9uc2VzOiBhbnlbXSkge1xyXG4gIGNvbnN0IHJhdGluZ0NvdW50czogUmVjb3JkPG51bWJlciwgbnVtYmVyPiA9IHt9O1xyXG4gIGNvbnN0IHJhdGluZ3MgPSBbMSwgMiwgMywgNCwgNSwgNiwgN107IC8vIEVzY2FsYSBjb23Dum5cclxuXHJcbiAgLy8gSW5pY2lhbGl6YXIgY29udGFkb3Jlc1xyXG4gIHJhdGluZ3MuZm9yRWFjaChyYXRpbmcgPT4ge1xyXG4gICAgcmF0aW5nQ291bnRzW3JhdGluZ10gPSAwO1xyXG4gIH0pO1xyXG5cclxuICAvLyBDb250YXIgcmVzcHVlc3Rhc1xyXG4gIGxldCB0b3RhbCA9IDA7XHJcbiAgbGV0IHN1bSA9IDA7XHJcbiAgXHJcbiAgcmVzcG9uc2VzLmZvckVhY2gocmVzcG9uc2UgPT4ge1xyXG4gICAgaWYgKHJlc3BvbnNlLnZhbHVlX251bWVyaWMgIT09IG51bGwgJiYgcmVzcG9uc2UudmFsdWVfbnVtZXJpYyAhPT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgIGNvbnN0IHJhdGluZyA9IE51bWJlcihyZXNwb25zZS52YWx1ZV9udW1lcmljKTtcclxuICAgICAgaWYgKHJhdGluZ3MuaW5jbHVkZXMocmF0aW5nKSkge1xyXG4gICAgICAgIHJhdGluZ0NvdW50c1tyYXRpbmddKys7XHJcbiAgICAgICAgdG90YWwrKztcclxuICAgICAgICBzdW0gKz0gcmF0aW5nO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgfSk7XHJcblxyXG4gIGNvbnN0IGNoYXJ0RGF0YSA9IE9iamVjdC5lbnRyaWVzKHJhdGluZ0NvdW50cykubWFwKChbcmF0aW5nLCBjb3VudF0pID0+ICh7XHJcbiAgICByYXRpbmc6IE51bWJlcihyYXRpbmcpLFxyXG4gICAgY291bnQsXHJcbiAgICBwZXJjZW50YWdlOiB0b3RhbCA+IDAgPyBwYXJzZUZsb2F0KChjb3VudCAvIHRvdGFsICogMTAwKS50b0ZpeGVkKDEpKSA6IDBcclxuICB9KSk7XHJcblxyXG4gIHJldHVybiB7XHJcbiAgICBjaGFydF9kYXRhOiBjaGFydERhdGEsXHJcbiAgICB0b3RhbF9yZXNwb25zZXM6IHRvdGFsLFxyXG4gICAgYXZlcmFnZV9yYXRpbmc6IHRvdGFsID4gMCA/IHBhcnNlRmxvYXQoKHN1bSAvIHRvdGFsKS50b0ZpeGVkKDIpKSA6IDAsXHJcbiAgICBtZWRpYW5fcmF0aW5nOiBjYWxjdWxhdGVNZWRpYW4ocmVzcG9uc2VzKSxcclxuICAgIGRpc3RyaWJ1dGlvbjogY2hhcnREYXRhXHJcbiAgfTtcclxufVxyXG5cclxuZnVuY3Rpb24gcHJvY2Vzc1RleHRBbmFseXRpY3MocmVzcG9uc2VzOiBhbnlbXSkge1xyXG4gIGNvbnN0IHRleHRSZXNwb25zZXMgPSByZXNwb25zZXNcclxuICAgIC5maWx0ZXIociA9PiByLnZhbHVlX3RleHQgJiYgci52YWx1ZV90ZXh0LnRyaW0oKS5sZW5ndGggPiAwKVxyXG4gICAgLm1hcChyID0+ICh7XHJcbiAgICAgIHRleHQ6IHIudmFsdWVfdGV4dCxcclxuICAgICAgbGVuZ3RoOiByLnZhbHVlX3RleHQubGVuZ3RoLFxyXG4gICAgICB3b3JkX2NvdW50OiByLnZhbHVlX3RleHQuc3BsaXQoL1xccysvKS5maWx0ZXIoKHc6IHN0cmluZykgPT4gdy5sZW5ndGggPiAwKS5sZW5ndGhcclxuICAgIH0pKTtcclxuXHJcbiAgLy8gQW7DoWxpc2lzIGLDoXNpY28gZGUgdGV4dG9cclxuICBjb25zdCB3b3JkRnJlcXVlbmNpZXMgPSBhbmFseXplV29yZEZyZXF1ZW5jeSh0ZXh0UmVzcG9uc2VzLm1hcCgocjogYW55KSA9PiByLnRleHQpKTtcclxuICBjb25zdCBhdmdMZW5ndGggPSB0ZXh0UmVzcG9uc2VzLmxlbmd0aCA+IDAgXHJcbiAgICA/IHRleHRSZXNwb25zZXMucmVkdWNlKChzdW06IG51bWJlciwgcjogYW55KSA9PiBzdW0gKyByLmxlbmd0aCwgMCkgLyB0ZXh0UmVzcG9uc2VzLmxlbmd0aCBcclxuICAgIDogMDtcclxuICBjb25zdCBhdmdXb3JkQ291bnQgPSB0ZXh0UmVzcG9uc2VzLmxlbmd0aCA+IDAgXHJcbiAgICA/IHRleHRSZXNwb25zZXMucmVkdWNlKChzdW06IG51bWJlciwgcjogYW55KSA9PiBzdW0gKyByLndvcmRfY291bnQsIDApIC8gdGV4dFJlc3BvbnNlcy5sZW5ndGggXHJcbiAgICA6IDA7XHJcblxyXG4gIHJldHVybiB7XHJcbiAgICB0b3RhbF9yZXNwb25zZXM6IHRleHRSZXNwb25zZXMubGVuZ3RoLFxyXG4gICAgc2FtcGxlX3Jlc3BvbnNlczogdGV4dFJlc3BvbnNlcy5zbGljZSgwLCAxMCksIC8vIE1vc3RyYXIgc29sbyAxMFxyXG4gICAgd29yZF9mcmVxdWVuY2llczogd29yZEZyZXF1ZW5jaWVzLnNsaWNlKDAsIDIwKSwgLy8gVG9wIDIwIHBhbGFicmFzXHJcbiAgICBhdmVyYWdlX2xlbmd0aDogTWF0aC5yb3VuZChhdmdMZW5ndGgpLFxyXG4gICAgYXZlcmFnZV93b3JkX2NvdW50OiBNYXRoLnJvdW5kKGF2Z1dvcmRDb3VudCksXHJcbiAgICBzaG9ydGVzdF9yZXNwb25zZTogdGV4dFJlc3BvbnNlcy5sZW5ndGggPiAwIFxyXG4gICAgICA/IHRleHRSZXNwb25zZXMucmVkdWNlKChtaW46IGFueSwgcjogYW55KSA9PiByLmxlbmd0aCA8IG1pbi5sZW5ndGggPyByIDogbWluLCB0ZXh0UmVzcG9uc2VzWzBdKVxyXG4gICAgICA6IG51bGwsXHJcbiAgICBsb25nZXN0X3Jlc3BvbnNlOiB0ZXh0UmVzcG9uc2VzLmxlbmd0aCA+IDAgXHJcbiAgICAgID8gdGV4dFJlc3BvbnNlcy5yZWR1Y2UoKG1heDogYW55LCByOiBhbnkpID0+IHIubGVuZ3RoID4gbWF4Lmxlbmd0aCA/IHIgOiBtYXgsIHRleHRSZXNwb25zZXNbMF0pXHJcbiAgICAgIDogbnVsbFxyXG4gIH07XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGNhbGN1bGF0ZURldmljZVN0YXRzKHJlc3BvbnNlczogYW55W10pIHtcclxuICBjb25zdCBzdGF0cyA9IHtcclxuICAgIG1vYmlsZTogMCxcclxuICAgIGRlc2t0b3A6IDAsXHJcbiAgICB0YWJsZXQ6IDAsXHJcbiAgICBicm93c2Vyczoge30gYXMgUmVjb3JkPHN0cmluZywgbnVtYmVyPixcclxuICAgIG9wZXJhdGluZ19zeXN0ZW1zOiB7fSBhcyBSZWNvcmQ8c3RyaW5nLCBudW1iZXI+LFxyXG4gICAgdG90YWw6IHJlc3BvbnNlcy5sZW5ndGhcclxuICB9O1xyXG5cclxuICByZXNwb25zZXMuZm9yRWFjaChyZXNwb25zZSA9PiB7XHJcbiAgICBjb25zdCBtZXRhID0gcmVzcG9uc2UubWV0YSB8fCB7fTtcclxuICAgIFxyXG4gICAgLy8gRGV0ZWN0YXIgZGlzcG9zaXRpdm9cclxuICAgIGlmIChtZXRhLmlzX21vYmlsZSkge1xyXG4gICAgICBzdGF0cy5tb2JpbGUrKztcclxuICAgIH0gZWxzZSBpZiAobWV0YS5pc190YWJsZXQpIHtcclxuICAgICAgc3RhdHMudGFibGV0Kys7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBzdGF0cy5kZXNrdG9wKys7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gTmF2ZWdhZG9yXHJcbiAgICBpZiAobWV0YS5icm93c2VyKSB7XHJcbiAgICAgIGNvbnN0IGJyb3dzZXIgPSBtZXRhLmJyb3dzZXIuc3BsaXQoJyAnKVswXTsgLy8gVG9tYXIgc29sbyBlbCBub21icmUgcHJpbmNpcGFsXHJcbiAgICAgIHN0YXRzLmJyb3dzZXJzW2Jyb3dzZXJdID0gKHN0YXRzLmJyb3dzZXJzW2Jyb3dzZXJdIHx8IDApICsgMTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBTaXN0ZW1hIG9wZXJhdGl2b1xyXG4gICAgaWYgKG1ldGEub3MpIHtcclxuICAgICAgc3RhdHMub3BlcmF0aW5nX3N5c3RlbXNbbWV0YS5vc10gPSAoc3RhdHMub3BlcmF0aW5nX3N5c3RlbXNbbWV0YS5vc10gfHwgMCkgKyAxO1xyXG4gICAgfVxyXG4gIH0pO1xyXG5cclxuICBjb25zdCB0b3RhbCA9IHN0YXRzLnRvdGFsIHx8IDE7IC8vIEV2aXRhciBkaXZpc2nDs24gcG9yIDBcclxuXHJcbiAgcmV0dXJuIHtcclxuICAgIC4uLnN0YXRzLFxyXG4gICAgbW9iaWxlX3BlcmNlbnRhZ2U6IHRvdGFsID4gMCA/IHBhcnNlRmxvYXQoKChzdGF0cy5tb2JpbGUgLyB0b3RhbCkgKiAxMDApLnRvRml4ZWQoMSkpIDogMCxcclxuICAgIGRlc2t0b3BfcGVyY2VudGFnZTogdG90YWwgPiAwID8gcGFyc2VGbG9hdCgoKHN0YXRzLmRlc2t0b3AgLyB0b3RhbCkgKiAxMDApLnRvRml4ZWQoMSkpIDogMCxcclxuICAgIHRhYmxldF9wZXJjZW50YWdlOiB0b3RhbCA+IDAgPyBwYXJzZUZsb2F0KCgoc3RhdHMudGFibGV0IC8gdG90YWwpICogMTAwKS50b0ZpeGVkKDEpKSA6IDAsXHJcbiAgICB0b3BfYnJvd3NlcjogT2JqZWN0LmVudHJpZXMoc3RhdHMuYnJvd3NlcnMpLnNvcnQoKGEsIGIpID0+IGJbMV0gLSBhWzFdKVswXT8uWzBdIHx8ICdEZXNjb25vY2lkbycsXHJcbiAgICB0b3Bfb3M6IE9iamVjdC5lbnRyaWVzKHN0YXRzLm9wZXJhdGluZ19zeXN0ZW1zKS5zb3J0KChhLCBiKSA9PiBiWzFdIC0gYVsxXSlbMF0/LlswXSB8fCAnRGVzY29ub2NpZG8nXHJcbiAgfTtcclxufVxyXG5cclxuYXN5bmMgZnVuY3Rpb24gY2FsY3VsYXRlUmVzcG9uc2VUcmVuZChzdXBhYmFzZTogYW55LCBzdXJ2ZXlJZDogc3RyaW5nKSB7XHJcbiAgY29uc3Qgc2V2ZW5EYXlzQWdvID0gbmV3IERhdGUoKTtcclxuICBzZXZlbkRheXNBZ28uc2V0RGF0ZShzZXZlbkRheXNBZ28uZ2V0RGF0ZSgpIC0gNyk7XHJcblxyXG4gIGNvbnN0IHsgZGF0YTogZGFpbHlSZXNwb25zZXMsIGVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxyXG4gICAgLmZyb20oJ3Jlc3BvbnNlcycpXHJcbiAgICAuc2VsZWN0KCdzdWJtaXR0ZWRfYXQnKVxyXG4gICAgLmVxKCdzdXJ2ZXlfaWQnLCBzdXJ2ZXlJZClcclxuICAgIC5ndGUoJ3N1Ym1pdHRlZF9hdCcsIHNldmVuRGF5c0Fnby50b0lTT1N0cmluZygpKVxyXG4gICAgLm9yZGVyKCdzdWJtaXR0ZWRfYXQnLCB7IGFzY2VuZGluZzogdHJ1ZSB9KTtcclxuXHJcbiAgaWYgKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciBmZXRjaGluZyByZXNwb25zZSB0cmVuZDonLCBlcnJvcik7XHJcbiAgICByZXR1cm4gW107XHJcbiAgfVxyXG5cclxuICAvLyBBZ3J1cGFyIHBvciBkw61hXHJcbiAgY29uc3QgZGFpbHlDb3VudHM6IFJlY29yZDxzdHJpbmcsIG51bWJlcj4gPSB7fTtcclxuICBcclxuICBkYWlseVJlc3BvbnNlcz8uZm9yRWFjaCgocmVzcG9uc2U6IGFueSkgPT4ge1xyXG4gICAgY29uc3QgZGF0ZSA9IG5ldyBEYXRlKHJlc3BvbnNlLnN1Ym1pdHRlZF9hdCkudG9JU09TdHJpbmcoKS5zcGxpdCgnVCcpWzBdO1xyXG4gICAgZGFpbHlDb3VudHNbZGF0ZV0gPSAoZGFpbHlDb3VudHNbZGF0ZV0gfHwgMCkgKyAxO1xyXG4gIH0pO1xyXG5cclxuICAvLyBSZWxsZW5hciBkw61hcyBzaW4gcmVzcHVlc3Rhc1xyXG4gIGNvbnN0IHRyZW5kRGF0YSA9IFtdO1xyXG4gIGZvciAobGV0IGkgPSA2OyBpID49IDA7IGktLSkge1xyXG4gICAgY29uc3QgZGF0ZSA9IG5ldyBEYXRlKCk7XHJcbiAgICBkYXRlLnNldERhdGUoZGF0ZS5nZXREYXRlKCkgLSBpKTtcclxuICAgIGNvbnN0IGRhdGVTdHIgPSBkYXRlLnRvSVNPU3RyaW5nKCkuc3BsaXQoJ1QnKVswXTtcclxuICAgIHRyZW5kRGF0YS5wdXNoKHtcclxuICAgICAgZGF0ZTogZGF0ZVN0cixcclxuICAgICAgY291bnQ6IGRhaWx5Q291bnRzW2RhdGVTdHJdIHx8IDBcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgcmV0dXJuIHRyZW5kRGF0YTtcclxufVxyXG5cclxuZnVuY3Rpb24gY2FsY3VsYXRlQ29tcGxldGlvblJhdGUodG90YWxRdWVzdGlvbnM6IG51bWJlciwgcmVzcG9uc2VzOiBhbnlbXSkge1xyXG4gIGlmIChyZXNwb25zZXMubGVuZ3RoID09PSAwIHx8IHRvdGFsUXVlc3Rpb25zID09PSAwKSByZXR1cm4gMDtcclxuICBcclxuICBsZXQgdG90YWxBbnN3ZXJlZCA9IDA7XHJcbiAgcmVzcG9uc2VzLmZvckVhY2goKHJlc3BvbnNlOiBhbnkpID0+IHtcclxuICAgIGNvbnN0IGFuc3dlcmVkID0gcmVzcG9uc2UucmVzcG9uc2VfaXRlbXM/Lmxlbmd0aCB8fCAwO1xyXG4gICAgdG90YWxBbnN3ZXJlZCArPSBhbnN3ZXJlZCAvIHRvdGFsUXVlc3Rpb25zO1xyXG4gIH0pO1xyXG4gIFxyXG4gIHJldHVybiBwYXJzZUZsb2F0KCgodG90YWxBbnN3ZXJlZCAvIHJlc3BvbnNlcy5sZW5ndGgpICogMTAwKS50b0ZpeGVkKDEpKTtcclxufVxyXG5cclxuZnVuY3Rpb24gY2FsY3VsYXRlQXZlcmFnZVJlc3BvbnNlVGltZShyZXNwb25zZXM6IGFueVtdKSB7XHJcbiAgLy8gRXN0byBhc3VtZSBxdWUgdGllbmVzIHVuIGNhbXBvIGRlIHRpZW1wbyBkZSBpbmljaW8geSBmaW5cclxuICAvLyBQb3IgYWhvcmEsIHJldG9ybmFyIHVuIHZhbG9yIGVzdGltYWRvIGJhc2FkbyBlbiBsYSBjYW50aWRhZCBkZSBwcmVndW50YXNcclxuICBpZiAocmVzcG9uc2VzLmxlbmd0aCA9PT0gMCkgcmV0dXJuICcwJztcclxuICBcclxuICBjb25zdCBlc3RpbWF0ZWRUaW1lUGVyUXVlc3Rpb24gPSAxNTsgLy8gc2VndW5kb3MgcG9yIHByZWd1bnRhXHJcbiAgY29uc3QgYXZnUXVlc3Rpb25zQW5zd2VyZWQgPSByZXNwb25zZXMucmVkdWNlKChzdW06IG51bWJlciwgcjogYW55KSA9PiBcclxuICAgIHN1bSArIChyLnJlc3BvbnNlX2l0ZW1zPy5sZW5ndGggfHwgMCksIDApIC8gcmVzcG9uc2VzLmxlbmd0aDtcclxuICBcclxuICBjb25zdCBhdmdTZWNvbmRzID0gYXZnUXVlc3Rpb25zQW5zd2VyZWQgKiBlc3RpbWF0ZWRUaW1lUGVyUXVlc3Rpb247XHJcbiAgY29uc3QgbWludXRlcyA9IE1hdGguZmxvb3IoYXZnU2Vjb25kcyAvIDYwKTtcclxuICBcclxuICByZXR1cm4gbWludXRlcyA+IDAgPyBgJHttaW51dGVzfW1gIDogYCR7TWF0aC5yb3VuZChhdmdTZWNvbmRzKX1zYDtcclxufVxyXG5cclxuZnVuY3Rpb24gY2FsY3VsYXRlTWVkaWFuKHJlc3BvbnNlczogYW55W10pIHtcclxuICBjb25zdCByYXRpbmdzID0gcmVzcG9uc2VzXHJcbiAgICAubWFwKChyOiBhbnkpID0+IHIudmFsdWVfbnVtZXJpYylcclxuICAgIC5maWx0ZXIoKHI6IGFueSkgPT4gciAhPT0gbnVsbCAmJiByICE9PSB1bmRlZmluZWQpXHJcbiAgICAuc29ydCgoYTogbnVtYmVyLCBiOiBudW1iZXIpID0+IGEgLSBiKTtcclxuICBcclxuICBpZiAocmF0aW5ncy5sZW5ndGggPT09IDApIHJldHVybiAwO1xyXG4gIFxyXG4gIGNvbnN0IG1pZGRsZSA9IE1hdGguZmxvb3IocmF0aW5ncy5sZW5ndGggLyAyKTtcclxuICBpZiAocmF0aW5ncy5sZW5ndGggJSAyID09PSAwKSB7XHJcbiAgICByZXR1cm4gKHJhdGluZ3NbbWlkZGxlIC0gMV0gKyByYXRpbmdzW21pZGRsZV0pIC8gMjtcclxuICB9XHJcbiAgcmV0dXJuIHJhdGluZ3NbbWlkZGxlXTtcclxufVxyXG5cclxuZnVuY3Rpb24gYW5hbHl6ZVdvcmRGcmVxdWVuY3kodGV4dHM6IHN0cmluZ1tdKSB7XHJcbiAgY29uc3Qgd29yZE1hcDogUmVjb3JkPHN0cmluZywgbnVtYmVyPiA9IHt9O1xyXG4gIGNvbnN0IHN0b3BXb3JkcyA9IG5ldyBTZXQoWydlbCcsICdsYScsICdsb3MnLCAnbGFzJywgJ3VuJywgJ3VuYScsICdkZScsICdxdWUnLCAneScsICdlbicsICdhJywgJ2NvbiddKTtcclxuICBcclxuICB0ZXh0cy5mb3JFYWNoKHRleHQgPT4ge1xyXG4gICAgY29uc3Qgd29yZHMgPSB0ZXh0LnRvTG93ZXJDYXNlKClcclxuICAgICAgLnJlcGxhY2UoL1teXFx3XFxzw6HDqcOtw7PDusOxXS9nLCAnJylcclxuICAgICAgLnNwbGl0KC9cXHMrLylcclxuICAgICAgLmZpbHRlcih3b3JkID0+IHdvcmQubGVuZ3RoID4gMiAmJiAhc3RvcFdvcmRzLmhhcyh3b3JkKSk7XHJcbiAgICBcclxuICAgIHdvcmRzLmZvckVhY2god29yZCA9PiB7XHJcbiAgICAgIHdvcmRNYXBbd29yZF0gPSAod29yZE1hcFt3b3JkXSB8fCAwKSArIDE7XHJcbiAgICB9KTtcclxuICB9KTtcclxuICBcclxuICByZXR1cm4gT2JqZWN0LmVudHJpZXMod29yZE1hcClcclxuICAgIC5zb3J0KChhLCBiKSA9PiBiWzFdIC0gYVsxXSlcclxuICAgIC5tYXAoKFt3b3JkLCBjb3VudF0pID0+ICh7IHdvcmQsIGNvdW50IH0pKTtcclxufSJdLCJuYW1lcyI6WyJOZXh0UmVzcG9uc2UiLCJzdXBhYmFzZVNlcnZlciIsIkdFVCIsInJlcXVlc3QiLCJwYXJhbXMiLCJzdXBhYmFzZSIsImRhdGEiLCJ1c2VyIiwiZXJyb3IiLCJhdXRoRXJyb3IiLCJhdXRoIiwiZ2V0VXNlciIsImpzb24iLCJzdGF0dXMiLCJzdXJ2ZXkiLCJzdXJ2ZXlFcnJvciIsImZyb20iLCJzZWxlY3QiLCJlcSIsImlkIiwic2luZ2xlIiwiY291bnQiLCJ0b3RhbFJlc3BvbnNlcyIsImNvdW50RXJyb3IiLCJoZWFkIiwiY29uc29sZSIsInF1ZXN0aW9ucyIsInF1ZXN0aW9uc0Vycm9yIiwib3JkZXIiLCJhc2NlbmRpbmciLCJyZXNwb25zZXMiLCJyZXNwb25zZXNFcnJvciIsInF1ZXN0aW9uc1dpdGhBbmFseXRpY3MiLCJwcm9jZXNzUXVlc3Rpb25zQW5hbHl0aWNzIiwiZGV2aWNlU3RhdHMiLCJjYWxjdWxhdGVEZXZpY2VTdGF0cyIsInJlc3BvbnNlVHJlbmQiLCJjYWxjdWxhdGVSZXNwb25zZVRyZW5kIiwicmVzdWx0Iiwic3VjY2VzcyIsInRpdGxlIiwiZGVzY3JpcHRpb24iLCJjcmVhdGVkX2F0IiwicHVibGlzaGVkX2F0IiwicHVibGlzaF9hdCIsInRvdGFsX3Jlc3BvbnNlcyIsInN1bW1hcnkiLCJjb21wbGV0aW9uX3JhdGUiLCJjYWxjdWxhdGVDb21wbGV0aW9uUmF0ZSIsImxlbmd0aCIsImF2Z19yZXNwb25zZV90aW1lIiwiY2FsY3VsYXRlQXZlcmFnZVJlc3BvbnNlVGltZSIsImRldmljZV9zdGF0cyIsInJlc3BvbnNlX3RyZW5kIiwicmF3X3Jlc3BvbnNlc19jb3VudCIsImRldGFpbHMiLCJFcnJvciIsIm1lc3NhZ2UiLCJQcm9taXNlIiwiYWxsIiwibWFwIiwicXVlc3Rpb24iLCJxdWVzdGlvblJlc3BvbnNlcyIsImZsYXRNYXAiLCJyIiwicmVzcG9uc2VfaXRlbXMiLCJmaWx0ZXIiLCJyaSIsInF1ZXN0aW9uX2lkIiwiYW5hbHl0aWNzRGF0YSIsInR5cGUiLCJwcm9jZXNzU2luZ2xlQ2hvaWNlQW5hbHl0aWNzIiwicHJvY2Vzc011bHRpcGxlQ2hvaWNlQW5hbHl0aWNzIiwicHJvY2Vzc0xpa2VydEFuYWx5dGljcyIsInByb2Nlc3NUZXh0QW5hbHl0aWNzIiwidW5zdXBwb3J0ZWQiLCJxdWVzdGlvbl90ZXh0IiwicmVxdWlyZWQiLCJwb3NpdGlvbiIsInJlc3BvbnNlX2NvdW50IiwiYW5hbHl0aWNzIiwib3B0aW9ucyIsInN1cnZleV9vcHRpb25zIiwib3B0aW9uQ291bnRzIiwiZm9yRWFjaCIsIm9wdCIsImxhYmVsIiwidmFsdWUiLCJyZXNwb25zZSIsInZhbHVlX3RleHQiLCJ0b3RhbCIsImNoYXJ0RGF0YSIsIk9iamVjdCIsImVudHJpZXMiLCJvcHRpb24iLCJwZXJjZW50YWdlIiwicGFyc2VGbG9hdCIsInRvRml4ZWQiLCJjaGFydF9kYXRhIiwibW9zdF9zZWxlY3RlZCIsInJlZHVjZSIsIm1heCIsIml0ZW0iLCJ0b3RhbFNlbGVjdGlvbnMiLCJ2YWx1ZV9qc29uIiwiQXJyYXkiLCJpc0FycmF5IiwidW5kZWZpbmVkIiwic2VsZWN0aW9uX3BlcmNlbnRhZ2UiLCJyZXNwb25kZW50X3BlcmNlbnRhZ2UiLCJ0b3RhbF9zZWxlY3Rpb25zIiwiYXZnX3NlbGVjdGlvbnNfcGVyX3Jlc3BvbnNlIiwicmF0aW5nQ291bnRzIiwicmF0aW5ncyIsInJhdGluZyIsInN1bSIsInZhbHVlX251bWVyaWMiLCJOdW1iZXIiLCJpbmNsdWRlcyIsImF2ZXJhZ2VfcmF0aW5nIiwibWVkaWFuX3JhdGluZyIsImNhbGN1bGF0ZU1lZGlhbiIsImRpc3RyaWJ1dGlvbiIsInRleHRSZXNwb25zZXMiLCJ0cmltIiwidGV4dCIsIndvcmRfY291bnQiLCJzcGxpdCIsInciLCJ3b3JkRnJlcXVlbmNpZXMiLCJhbmFseXplV29yZEZyZXF1ZW5jeSIsImF2Z0xlbmd0aCIsImF2Z1dvcmRDb3VudCIsInNhbXBsZV9yZXNwb25zZXMiLCJzbGljZSIsIndvcmRfZnJlcXVlbmNpZXMiLCJhdmVyYWdlX2xlbmd0aCIsIk1hdGgiLCJyb3VuZCIsImF2ZXJhZ2Vfd29yZF9jb3VudCIsInNob3J0ZXN0X3Jlc3BvbnNlIiwibWluIiwibG9uZ2VzdF9yZXNwb25zZSIsInN0YXRzIiwibW9iaWxlIiwiZGVza3RvcCIsInRhYmxldCIsImJyb3dzZXJzIiwib3BlcmF0aW5nX3N5c3RlbXMiLCJtZXRhIiwiaXNfbW9iaWxlIiwiaXNfdGFibGV0IiwiYnJvd3NlciIsIm9zIiwibW9iaWxlX3BlcmNlbnRhZ2UiLCJkZXNrdG9wX3BlcmNlbnRhZ2UiLCJ0YWJsZXRfcGVyY2VudGFnZSIsInRvcF9icm93c2VyIiwic29ydCIsImEiLCJiIiwidG9wX29zIiwic3VydmV5SWQiLCJzZXZlbkRheXNBZ28iLCJEYXRlIiwic2V0RGF0ZSIsImdldERhdGUiLCJkYWlseVJlc3BvbnNlcyIsImd0ZSIsInRvSVNPU3RyaW5nIiwiZGFpbHlDb3VudHMiLCJkYXRlIiwic3VibWl0dGVkX2F0IiwidHJlbmREYXRhIiwiaSIsImRhdGVTdHIiLCJwdXNoIiwidG90YWxRdWVzdGlvbnMiLCJ0b3RhbEFuc3dlcmVkIiwiYW5zd2VyZWQiLCJlc3RpbWF0ZWRUaW1lUGVyUXVlc3Rpb24iLCJhdmdRdWVzdGlvbnNBbnN3ZXJlZCIsImF2Z1NlY29uZHMiLCJtaW51dGVzIiwiZmxvb3IiLCJtaWRkbGUiLCJ0ZXh0cyIsIndvcmRNYXAiLCJzdG9wV29yZHMiLCJTZXQiLCJ3b3JkcyIsInRvTG93ZXJDYXNlIiwicmVwbGFjZSIsIndvcmQiLCJoYXMiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./app/api/surveys/[id]/analytics/route.ts\n");

/***/ }),

/***/ "(rsc)/./lib/supabaseServer.ts":
/*!*******************************!*\
  !*** ./lib/supabaseServer.ts ***!
  \*******************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   supabaseServer: () => (/* binding */ supabaseServer)\n/* harmony export */ });\n/* harmony import */ var next_headers__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/headers */ \"(rsc)/./node_modules/next/dist/api/headers.js\");\n/* harmony import */ var _supabase_ssr__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @supabase/ssr */ \"(rsc)/./node_modules/@supabase/ssr/dist/module/index.js\");\n// lib/supabaseServer.ts\n\n\nfunction supabaseServer() {\n    const cookieStore = (0,next_headers__WEBPACK_IMPORTED_MODULE_0__.cookies)();\n    return (0,_supabase_ssr__WEBPACK_IMPORTED_MODULE_1__.createServerClient)(\"https://jfagkzxzkbslpohhojuh.supabase.co\", \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImpmYWdrenh6a2JzbHBvaGhvanVoIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjI0NDIyNjQsImV4cCI6MjA3ODAxODI2NH0.y8rKE8CyNK54GkqRRDalX5hyPy1YrG8NVj6mr2sgKPU\", {\n        cookies: {\n            getAll () {\n                return cookieStore.getAll();\n            },\n            setAll (cookiesToSet) {\n                try {\n                    cookiesToSet.forEach(({ name, value, options })=>{\n                        cookieStore.set(name, value, options);\n                    });\n                } catch  {\n                // Esto puede fallar en middleware\n                }\n            }\n        }\n    });\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9saWIvc3VwYWJhc2VTZXJ2ZXIudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQUEsd0JBQXdCO0FBQ2U7QUFDZ0M7QUFFaEUsU0FBU0U7SUFDZCxNQUFNQyxjQUFjSCxxREFBT0E7SUFFM0IsT0FBT0MsaUVBQWtCQSxDQUN2QkcsMENBQW9DLEVBQ3BDQSxrTkFBeUMsRUFDekM7UUFDRUosU0FBUztZQUNQUTtnQkFDRSxPQUFPTCxZQUFZSyxNQUFNO1lBQzNCO1lBQ0FDLFFBQU9DLFlBQXVFO2dCQUM1RSxJQUFJO29CQUNGQSxhQUFhQyxPQUFPLENBQUMsQ0FBQyxFQUFFQyxJQUFJLEVBQUVDLEtBQUssRUFBRUMsT0FBTyxFQUFFO3dCQUM1Q1gsWUFBWVksR0FBRyxDQUFDSCxNQUFNQyxPQUFPQztvQkFDL0I7Z0JBQ0YsRUFBRSxPQUFNO2dCQUNOLGtDQUFrQztnQkFDcEM7WUFDRjtRQUNGO0lBQ0Y7QUFFSiIsInNvdXJjZXMiOlsid2VicGFjazovL2VuY3Vlc3Rhcy1xci8uL2xpYi9zdXBhYmFzZVNlcnZlci50cz9jNzhjIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIGxpYi9zdXBhYmFzZVNlcnZlci50c1xyXG5pbXBvcnQgeyBjb29raWVzIH0gZnJvbSBcIm5leHQvaGVhZGVyc1wiO1xyXG5pbXBvcnQgeyBjcmVhdGVTZXJ2ZXJDbGllbnQsIHR5cGUgQ29va2llT3B0aW9ucyB9IGZyb20gXCJAc3VwYWJhc2Uvc3NyXCI7XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gc3VwYWJhc2VTZXJ2ZXIoKSB7XHJcbiAgY29uc3QgY29va2llU3RvcmUgPSBjb29raWVzKCk7XHJcblxyXG4gIHJldHVybiBjcmVhdGVTZXJ2ZXJDbGllbnQoXHJcbiAgICBwcm9jZXNzLmVudi5ORVhUX1BVQkxJQ19TVVBBQkFTRV9VUkwhLFxyXG4gICAgcHJvY2Vzcy5lbnYuTkVYVF9QVUJMSUNfU1VQQUJBU0VfQU5PTl9LRVkhLFxyXG4gICAge1xyXG4gICAgICBjb29raWVzOiB7XHJcbiAgICAgICAgZ2V0QWxsKCkge1xyXG4gICAgICAgICAgcmV0dXJuIGNvb2tpZVN0b3JlLmdldEFsbCgpO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgc2V0QWxsKGNvb2tpZXNUb1NldDogeyBuYW1lOiBzdHJpbmc7IHZhbHVlOiBzdHJpbmc7IG9wdGlvbnM6IENvb2tpZU9wdGlvbnMgfVtdKSB7XHJcbiAgICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICBjb29raWVzVG9TZXQuZm9yRWFjaCgoeyBuYW1lLCB2YWx1ZSwgb3B0aW9ucyB9KSA9PiB7XHJcbiAgICAgICAgICAgICAgY29va2llU3RvcmUuc2V0KG5hbWUsIHZhbHVlLCBvcHRpb25zKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICB9IGNhdGNoIHtcclxuICAgICAgICAgICAgLy8gRXN0byBwdWVkZSBmYWxsYXIgZW4gbWlkZGxld2FyZVxyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH0sXHJcbiAgICAgIH0sXHJcbiAgICB9XHJcbiAgKTtcclxufSJdLCJuYW1lcyI6WyJjb29raWVzIiwiY3JlYXRlU2VydmVyQ2xpZW50Iiwic3VwYWJhc2VTZXJ2ZXIiLCJjb29raWVTdG9yZSIsInByb2Nlc3MiLCJlbnYiLCJORVhUX1BVQkxJQ19TVVBBQkFTRV9VUkwiLCJORVhUX1BVQkxJQ19TVVBBQkFTRV9BTk9OX0tFWSIsImdldEFsbCIsInNldEFsbCIsImNvb2tpZXNUb1NldCIsImZvckVhY2giLCJuYW1lIiwidmFsdWUiLCJvcHRpb25zIiwic2V0Il0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./lib/supabaseServer.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next","vendor-chunks/@supabase","vendor-chunks/tr46","vendor-chunks/whatwg-url","vendor-chunks/cookie","vendor-chunks/webidl-conversions"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fsurveys%2F%5Bid%5D%2Fanalytics%2Froute&page=%2Fapi%2Fsurveys%2F%5Bid%5D%2Fanalytics%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fsurveys%2F%5Bid%5D%2Fanalytics%2Froute.ts&appDir=C%3A%5CProjects%5CMM100922-DevOps-QR%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CProjects%5CMM100922-DevOps-QR&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();