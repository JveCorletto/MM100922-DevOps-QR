"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/surveys/[id]/analytics/route";
exports.ids = ["app/api/surveys/[id]/analytics/route"];
exports.modules = {

/***/ "../../client/components/action-async-storage.external":
/*!*******************************************************************************!*\
  !*** external "next/dist/client/components/action-async-storage.external.js" ***!
  \*******************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/client/components/action-async-storage.external.js");

/***/ }),

/***/ "../../client/components/request-async-storage.external":
/*!********************************************************************************!*\
  !*** external "next/dist/client/components/request-async-storage.external.js" ***!
  \********************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/client/components/request-async-storage.external.js");

/***/ }),

/***/ "../../client/components/static-generation-async-storage.external":
/*!******************************************************************************************!*\
  !*** external "next/dist/client/components/static-generation-async-storage.external.js" ***!
  \******************************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/client/components/static-generation-async-storage.external.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-page.runtime.dev.js":
/*!*************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-page.runtime.dev.js" ***!
  \*************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-page.runtime.dev.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "buffer":
/*!*************************!*\
  !*** external "buffer" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("buffer");

/***/ }),

/***/ "crypto":
/*!*************************!*\
  !*** external "crypto" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("crypto");

/***/ }),

/***/ "events":
/*!*************************!*\
  !*** external "events" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("events");

/***/ }),

/***/ "http":
/*!***********************!*\
  !*** external "http" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("http");

/***/ }),

/***/ "https":
/*!************************!*\
  !*** external "https" ***!
  \************************/
/***/ ((module) => {

module.exports = require("https");

/***/ }),

/***/ "net":
/*!**********************!*\
  !*** external "net" ***!
  \**********************/
/***/ ((module) => {

module.exports = require("net");

/***/ }),

/***/ "punycode":
/*!***************************!*\
  !*** external "punycode" ***!
  \***************************/
/***/ ((module) => {

module.exports = require("punycode");

/***/ }),

/***/ "stream":
/*!*************************!*\
  !*** external "stream" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("stream");

/***/ }),

/***/ "tls":
/*!**********************!*\
  !*** external "tls" ***!
  \**********************/
/***/ ((module) => {

module.exports = require("tls");

/***/ }),

/***/ "url":
/*!**********************!*\
  !*** external "url" ***!
  \**********************/
/***/ ((module) => {

module.exports = require("url");

/***/ }),

/***/ "zlib":
/*!***********************!*\
  !*** external "zlib" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("zlib");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fsurveys%2F%5Bid%5D%2Fanalytics%2Froute&page=%2Fapi%2Fsurveys%2F%5Bid%5D%2Fanalytics%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fsurveys%2F%5Bid%5D%2Fanalytics%2Froute.ts&appDir=C%3A%5CProjects%5CMM100922-DevOps-QR%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CProjects%5CMM100922-DevOps-QR&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!**********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fsurveys%2F%5Bid%5D%2Fanalytics%2Froute&page=%2Fapi%2Fsurveys%2F%5Bid%5D%2Fanalytics%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fsurveys%2F%5Bid%5D%2Fanalytics%2Froute.ts&appDir=C%3A%5CProjects%5CMM100922-DevOps-QR%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CProjects%5CMM100922-DevOps-QR&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \**********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var C_Projects_MM100922_DevOps_QR_app_api_surveys_id_analytics_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./app/api/surveys/[id]/analytics/route.ts */ \"(rsc)/./app/api/surveys/[id]/analytics/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/surveys/[id]/analytics/route\",\n        pathname: \"/api/surveys/[id]/analytics\",\n        filename: \"route\",\n        bundlePath: \"app/api/surveys/[id]/analytics/route\"\n    },\n    resolvedPagePath: \"C:\\\\Projects\\\\MM100922-DevOps-QR\\\\app\\\\api\\\\surveys\\\\[id]\\\\analytics\\\\route.ts\",\n    nextConfigOutput,\n    userland: C_Projects_MM100922_DevOps_QR_app_api_surveys_id_analytics_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks } = routeModule;\nconst originalPathname = \"/api/surveys/[id]/analytics/route\";\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        serverHooks,\n        staticGenerationAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIuanM/bmFtZT1hcHAlMkZhcGklMkZzdXJ2ZXlzJTJGJTVCaWQlNUQlMkZhbmFseXRpY3MlMkZyb3V0ZSZwYWdlPSUyRmFwaSUyRnN1cnZleXMlMkYlNUJpZCU1RCUyRmFuYWx5dGljcyUyRnJvdXRlJmFwcFBhdGhzPSZwYWdlUGF0aD1wcml2YXRlLW5leHQtYXBwLWRpciUyRmFwaSUyRnN1cnZleXMlMkYlNUJpZCU1RCUyRmFuYWx5dGljcyUyRnJvdXRlLnRzJmFwcERpcj1DJTNBJTVDUHJvamVjdHMlNUNNTTEwMDkyMi1EZXZPcHMtUVIlNUNhcHAmcGFnZUV4dGVuc2lvbnM9dHN4JnBhZ2VFeHRlbnNpb25zPXRzJnBhZ2VFeHRlbnNpb25zPWpzeCZwYWdlRXh0ZW5zaW9ucz1qcyZyb290RGlyPUMlM0ElNUNQcm9qZWN0cyU1Q01NMTAwOTIyLURldk9wcy1RUiZpc0Rldj10cnVlJnRzY29uZmlnUGF0aD10c2NvbmZpZy5qc29uJmJhc2VQYXRoPSZhc3NldFByZWZpeD0mbmV4dENvbmZpZ091dHB1dD0mcHJlZmVycmVkUmVnaW9uPSZtaWRkbGV3YXJlQ29uZmlnPWUzMCUzRCEiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7O0FBQXNHO0FBQ3ZDO0FBQ2M7QUFDOEI7QUFDM0c7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLGdIQUFtQjtBQUMzQztBQUNBLGNBQWMseUVBQVM7QUFDdkI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLFlBQVk7QUFDWixDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0EsUUFBUSxpRUFBaUU7QUFDekU7QUFDQTtBQUNBLFdBQVcsNEVBQVc7QUFDdEI7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUN1SDs7QUFFdkgiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9lbmN1ZXN0YXMtcXIvPzA4MTAiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQXBwUm91dGVSb3V0ZU1vZHVsZSB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2Z1dHVyZS9yb3V0ZS1tb2R1bGVzL2FwcC1yb3V0ZS9tb2R1bGUuY29tcGlsZWRcIjtcbmltcG9ydCB7IFJvdXRlS2luZCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2Z1dHVyZS9yb3V0ZS1raW5kXCI7XG5pbXBvcnQgeyBwYXRjaEZldGNoIGFzIF9wYXRjaEZldGNoIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvbGliL3BhdGNoLWZldGNoXCI7XG5pbXBvcnQgKiBhcyB1c2VybGFuZCBmcm9tIFwiQzpcXFxcUHJvamVjdHNcXFxcTU0xMDA5MjItRGV2T3BzLVFSXFxcXGFwcFxcXFxhcGlcXFxcc3VydmV5c1xcXFxbaWRdXFxcXGFuYWx5dGljc1xcXFxyb3V0ZS50c1wiO1xuLy8gV2UgaW5qZWN0IHRoZSBuZXh0Q29uZmlnT3V0cHV0IGhlcmUgc28gdGhhdCB3ZSBjYW4gdXNlIHRoZW0gaW4gdGhlIHJvdXRlXG4vLyBtb2R1bGUuXG5jb25zdCBuZXh0Q29uZmlnT3V0cHV0ID0gXCJcIlxuY29uc3Qgcm91dGVNb2R1bGUgPSBuZXcgQXBwUm91dGVSb3V0ZU1vZHVsZSh7XG4gICAgZGVmaW5pdGlvbjoge1xuICAgICAgICBraW5kOiBSb3V0ZUtpbmQuQVBQX1JPVVRFLFxuICAgICAgICBwYWdlOiBcIi9hcGkvc3VydmV5cy9baWRdL2FuYWx5dGljcy9yb3V0ZVwiLFxuICAgICAgICBwYXRobmFtZTogXCIvYXBpL3N1cnZleXMvW2lkXS9hbmFseXRpY3NcIixcbiAgICAgICAgZmlsZW5hbWU6IFwicm91dGVcIixcbiAgICAgICAgYnVuZGxlUGF0aDogXCJhcHAvYXBpL3N1cnZleXMvW2lkXS9hbmFseXRpY3Mvcm91dGVcIlxuICAgIH0sXG4gICAgcmVzb2x2ZWRQYWdlUGF0aDogXCJDOlxcXFxQcm9qZWN0c1xcXFxNTTEwMDkyMi1EZXZPcHMtUVJcXFxcYXBwXFxcXGFwaVxcXFxzdXJ2ZXlzXFxcXFtpZF1cXFxcYW5hbHl0aWNzXFxcXHJvdXRlLnRzXCIsXG4gICAgbmV4dENvbmZpZ091dHB1dCxcbiAgICB1c2VybGFuZFxufSk7XG4vLyBQdWxsIG91dCB0aGUgZXhwb3J0cyB0aGF0IHdlIG5lZWQgdG8gZXhwb3NlIGZyb20gdGhlIG1vZHVsZS4gVGhpcyBzaG91bGRcbi8vIGJlIGVsaW1pbmF0ZWQgd2hlbiB3ZSd2ZSBtb3ZlZCB0aGUgb3RoZXIgcm91dGVzIHRvIHRoZSBuZXcgZm9ybWF0LiBUaGVzZVxuLy8gYXJlIHVzZWQgdG8gaG9vayBpbnRvIHRoZSByb3V0ZS5cbmNvbnN0IHsgcmVxdWVzdEFzeW5jU3RvcmFnZSwgc3RhdGljR2VuZXJhdGlvbkFzeW5jU3RvcmFnZSwgc2VydmVySG9va3MgfSA9IHJvdXRlTW9kdWxlO1xuY29uc3Qgb3JpZ2luYWxQYXRobmFtZSA9IFwiL2FwaS9zdXJ2ZXlzL1tpZF0vYW5hbHl0aWNzL3JvdXRlXCI7XG5mdW5jdGlvbiBwYXRjaEZldGNoKCkge1xuICAgIHJldHVybiBfcGF0Y2hGZXRjaCh7XG4gICAgICAgIHNlcnZlckhvb2tzLFxuICAgICAgICBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlXG4gICAgfSk7XG59XG5leHBvcnQgeyByb3V0ZU1vZHVsZSwgcmVxdWVzdEFzeW5jU3RvcmFnZSwgc3RhdGljR2VuZXJhdGlvbkFzeW5jU3RvcmFnZSwgc2VydmVySG9va3MsIG9yaWdpbmFsUGF0aG5hbWUsIHBhdGNoRmV0Y2gsICB9O1xuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1hcHAtcm91dGUuanMubWFwIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fsurveys%2F%5Bid%5D%2Fanalytics%2Froute&page=%2Fapi%2Fsurveys%2F%5Bid%5D%2Fanalytics%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fsurveys%2F%5Bid%5D%2Fanalytics%2Froute.ts&appDir=C%3A%5CProjects%5CMM100922-DevOps-QR%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CProjects%5CMM100922-DevOps-QR&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./app/api/surveys/[id]/analytics/route.ts":
/*!*************************************************!*\
  !*** ./app/api/surveys/[id]/analytics/route.ts ***!
  \*************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   GET: () => (/* binding */ GET)\n/* harmony export */ });\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(rsc)/./node_modules/next/dist/api/server.js\");\n/* harmony import */ var _lib_supabaseServer__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/lib/supabaseServer */ \"(rsc)/./lib/supabaseServer.ts\");\n\n\nasync function GET(request, { params }) {\n    try {\n        // 1. Crear cliente de Supabase con cookies SSR\n        const supabase = (0,_lib_supabaseServer__WEBPACK_IMPORTED_MODULE_1__.supabaseServer)();\n        // 2. Verificar autenticación\n        const { data: { user }, error: authError } = await supabase.auth.getUser();\n        if (!user || authError) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: \"No autorizado\"\n            }, {\n                status: 401\n            });\n        }\n        // 3. Verificar que el usuario es dueño de la encuesta\n        const { data: survey, error: surveyError } = await supabase.from(\"surveys\").select(`\r\n        *,\r\n        profiles!surveys_owner_id_fkey (id, display_name)\r\n      `).eq(\"id\", params.id).eq(\"owner_id\", user.id).single();\n        if (surveyError || !survey) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: \"Encuesta no encontrada o no autorizado\"\n            }, {\n                status: 404\n            });\n        }\n        // 4. Obtener estadísticas básicas\n        const { count: totalResponses, error: countError } = await supabase.from(\"responses\").select(\"id\", {\n            count: \"exact\",\n            head: true\n        }).eq(\"survey_id\", params.id);\n        if (countError) {\n            console.error(\"Error counting responses:\", countError);\n        }\n        // 5. Obtener preguntas con sus opciones\n        const { data: questions, error: questionsError } = await supabase.from(\"survey_questions\").select(`\r\n        *,\r\n        survey_options (\r\n          id,\r\n          label,\r\n          value,\r\n          position\r\n        )\r\n      `).eq(\"survey_id\", params.id).order(\"position\", {\n            ascending: true\n        });\n        if (questionsError) {\n            console.error(\"Error fetching questions:\", questionsError);\n        }\n        // 6. Obtener respuestas con metadatos\n        const { data: responses, error: responsesError } = await supabase.from(\"responses\").select(`\r\n        id,\r\n        submitted_at,\r\n        meta,\r\n        response_items (\r\n          question_id,\r\n          value_text,\r\n          value_numeric,\r\n          value_json\r\n        )\r\n      `).eq(\"survey_id\", params.id).order(\"submitted_at\", {\n            ascending: false\n        });\n        if (responsesError) {\n            console.error(\"Error fetching responses:\", responsesError);\n        }\n        // 7. Procesar datos para cada pregunta\n        const questionsWithAnalytics = await processQuestionsAnalytics(questions || [], responses || []);\n        // 8. Calcular estadísticas de dispositivo\n        const deviceStats = calculateDeviceStats(responses || []);\n        // 9. Calcular tasa de respuesta diaria (últimos 7 días)\n        const responseTrend = await calculateResponseTrend(supabase, params.id);\n        // 10. Preparar respuesta\n        const result = {\n            success: true,\n            data: {\n                survey: {\n                    id: survey.id,\n                    title: survey.title,\n                    status: survey.status,\n                    description: survey.description,\n                    created_at: survey.created_at,\n                    published_at: survey.publish_at,\n                    total_responses: totalResponses || 0\n                },\n                summary: {\n                    total_responses: totalResponses || 0,\n                    completion_rate: calculateCompletionRate(questions?.length || 0, responses || []),\n                    avg_response_time: calculateAverageResponseTime(responses || []),\n                    device_stats: deviceStats,\n                    response_trend: responseTrend\n                },\n                questions: questionsWithAnalytics,\n                raw_responses_count: responses?.length || 0\n            }\n        };\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json(result);\n    } catch (error) {\n        console.error(\"Error en analytics endpoint:\", error);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: \"Error interno del servidor\",\n            details: error instanceof Error ? error.message : \"Unknown error\"\n        }, {\n            status: 500\n        });\n    }\n}\n// Helper functions (las mismas que antes, pero con tipos mejorados)\nasync function processQuestionsAnalytics(questions, responses) {\n    // Procesar cada pregunta\n    return Promise.all(questions.map(async (question)=>{\n        // Filtrar respuestas para esta pregunta\n        const questionResponses = responses.flatMap((r)=>r.response_items?.filter((ri)=>ri.question_id === question.id) || []);\n        let analyticsData;\n        switch(question.type){\n            case \"single\":\n                analyticsData = processSingleChoiceAnalytics(question, questionResponses);\n                break;\n            case \"multiple\":\n                analyticsData = processMultipleChoiceAnalytics(question, questionResponses);\n                break;\n            case \"likert\":\n                analyticsData = processLikertAnalytics(question, questionResponses);\n                break;\n            case \"text\":\n                analyticsData = processTextAnalytics(questionResponses);\n                break;\n            default:\n                analyticsData = {\n                    type: question.type,\n                    unsupported: true\n                };\n        }\n        return {\n            id: question.id,\n            question_text: question.question_text,\n            type: question.type,\n            required: question.required,\n            position: question.position,\n            response_count: questionResponses.length,\n            analytics: analyticsData,\n            options: question.survey_options || []\n        };\n    }));\n}\nfunction processSingleChoiceAnalytics(question, responses) {\n    const optionCounts = {};\n    // Inicializar con opciones definidas\n    if (question.survey_options && question.survey_options.length > 0) {\n        question.survey_options.forEach((opt)=>{\n            optionCounts[opt.label || opt.value || \"\"] = 0;\n        });\n    }\n    // Contar respuestas\n    responses.forEach((response)=>{\n        if (response.value_text) {\n            const value = response.value_text;\n            optionCounts[value] = (optionCounts[value] || 0) + 1;\n        }\n    });\n    const total = responses.length;\n    const chartData = Object.entries(optionCounts).map(([option, count])=>({\n            option,\n            count,\n            percentage: total > 0 ? parseFloat((count / total * 100).toFixed(1)) : 0\n        }));\n    return {\n        chart_data: chartData,\n        total_responses: total,\n        most_selected: chartData.length > 0 ? chartData.reduce((max, item)=>item.count > max.count ? item : max) : null\n    };\n}\nfunction processMultipleChoiceAnalytics(question, responses) {\n    const optionCounts = {};\n    let totalSelections = 0;\n    // Inicializar con opciones definidas\n    if (question.survey_options && question.survey_options.length > 0) {\n        question.survey_options.forEach((opt)=>{\n            optionCounts[opt.label || opt.value || \"\"] = 0;\n        });\n    }\n    // Contar selecciones (pueden ser múltiples por respuesta)\n    responses.forEach((response)=>{\n        if (response.value_json && Array.isArray(response.value_json)) {\n            response.value_json.forEach((value)=>{\n                if (optionCounts[value] !== undefined) {\n                    optionCounts[value]++;\n                    totalSelections++;\n                }\n            });\n        }\n    });\n    const totalResponses = responses.length;\n    const chartData = Object.entries(optionCounts).map(([option, count])=>({\n            option,\n            count,\n            selection_percentage: totalSelections > 0 ? parseFloat((count / totalSelections * 100).toFixed(1)) : 0,\n            respondent_percentage: totalResponses > 0 ? parseFloat((count / totalResponses * 100).toFixed(1)) : 0\n        }));\n    return {\n        chart_data: chartData,\n        total_responses: totalResponses,\n        total_selections: totalSelections,\n        avg_selections_per_response: totalResponses > 0 ? parseFloat((totalSelections / totalResponses).toFixed(2)) : 0,\n        most_selected: chartData.length > 0 ? chartData.reduce((max, item)=>item.count > max.count ? item : max) : null\n    };\n}\nfunction processLikertAnalytics(question, responses) {\n    const ratingCounts = {};\n    const ratings = [\n        1,\n        2,\n        3,\n        4,\n        5,\n        6,\n        7\n    ]; // Escala común\n    // Inicializar contadores\n    ratings.forEach((rating)=>{\n        ratingCounts[rating] = 0;\n    });\n    // Contar respuestas\n    let total = 0;\n    let sum = 0;\n    responses.forEach((response)=>{\n        if (response.value_numeric !== null && response.value_numeric !== undefined) {\n            const rating = Number(response.value_numeric);\n            if (ratings.includes(rating)) {\n                ratingCounts[rating]++;\n                total++;\n                sum += rating;\n            }\n        }\n    });\n    const chartData = Object.entries(ratingCounts).map(([rating, count])=>({\n            rating: Number(rating),\n            count,\n            percentage: total > 0 ? parseFloat((count / total * 100).toFixed(1)) : 0\n        }));\n    return {\n        chart_data: chartData,\n        total_responses: total,\n        average_rating: total > 0 ? parseFloat((sum / total).toFixed(2)) : 0,\n        median_rating: calculateMedian(responses),\n        distribution: chartData\n    };\n}\nfunction processTextAnalytics(responses) {\n    const textResponses = responses.filter((r)=>r.value_text && r.value_text.trim().length > 0).map((r)=>({\n            text: r.value_text,\n            length: r.value_text.length,\n            word_count: r.value_text.split(/\\s+/).filter((w)=>w.length > 0).length\n        }));\n    // Análisis básico de texto\n    const wordFrequencies = analyzeWordFrequency(textResponses.map((r)=>r.text));\n    const avgLength = textResponses.length > 0 ? textResponses.reduce((sum, r)=>sum + r.length, 0) / textResponses.length : 0;\n    const avgWordCount = textResponses.length > 0 ? textResponses.reduce((sum, r)=>sum + r.word_count, 0) / textResponses.length : 0;\n    return {\n        total_responses: textResponses.length,\n        sample_responses: textResponses.slice(0, 10),\n        word_frequencies: wordFrequencies.slice(0, 20),\n        average_length: Math.round(avgLength),\n        average_word_count: Math.round(avgWordCount),\n        shortest_response: textResponses.length > 0 ? textResponses.reduce((min, r)=>r.length < min.length ? r : min, textResponses[0]) : null,\n        longest_response: textResponses.length > 0 ? textResponses.reduce((max, r)=>r.length > max.length ? r : max, textResponses[0]) : null\n    };\n}\nfunction calculateDeviceStats(responses) {\n    const stats = {\n        mobile: 0,\n        desktop: 0,\n        tablet: 0,\n        browsers: {},\n        operating_systems: {},\n        total: responses.length\n    };\n    responses.forEach((response)=>{\n        const meta = response.meta || {};\n        // Detectar dispositivo\n        if (meta.is_mobile) {\n            stats.mobile++;\n        } else if (meta.is_tablet) {\n            stats.tablet++;\n        } else {\n            stats.desktop++;\n        }\n        // Navegador\n        if (meta.browser) {\n            const browser = meta.browser.split(\" \")[0]; // Tomar solo el nombre principal\n            stats.browsers[browser] = (stats.browsers[browser] || 0) + 1;\n        }\n        // Sistema operativo\n        if (meta.os) {\n            stats.operating_systems[meta.os] = (stats.operating_systems[meta.os] || 0) + 1;\n        }\n    });\n    const total = stats.total || 1; // Evitar división por 0\n    return {\n        ...stats,\n        mobile_percentage: total > 0 ? parseFloat((stats.mobile / total * 100).toFixed(1)) : 0,\n        desktop_percentage: total > 0 ? parseFloat((stats.desktop / total * 100).toFixed(1)) : 0,\n        tablet_percentage: total > 0 ? parseFloat((stats.tablet / total * 100).toFixed(1)) : 0,\n        top_browser: Object.entries(stats.browsers).sort((a, b)=>b[1] - a[1])[0]?.[0] || \"Desconocido\",\n        top_os: Object.entries(stats.operating_systems).sort((a, b)=>b[1] - a[1])[0]?.[0] || \"Desconocido\"\n    };\n}\nasync function calculateResponseTrend(supabase, surveyId) {\n    const sevenDaysAgo = new Date();\n    sevenDaysAgo.setDate(sevenDaysAgo.getDate() - 7);\n    const { data: dailyResponses, error } = await supabase.from(\"responses\").select(\"submitted_at\").eq(\"survey_id\", surveyId).gte(\"submitted_at\", sevenDaysAgo.toISOString()).order(\"submitted_at\", {\n        ascending: true\n    });\n    if (error) {\n        console.error(\"Error fetching response trend:\", error);\n        return [];\n    }\n    // Agrupar por día\n    const dailyCounts = {};\n    dailyResponses?.forEach((response)=>{\n        const date = new Date(response.submitted_at).toISOString().split(\"T\")[0];\n        dailyCounts[date] = (dailyCounts[date] || 0) + 1;\n    });\n    // Rellenar días sin respuestas\n    const trendData = [];\n    for(let i = 6; i >= 0; i--){\n        const date = new Date();\n        date.setDate(date.getDate() - i);\n        const dateStr = date.toISOString().split(\"T\")[0];\n        trendData.push({\n            date: dateStr,\n            count: dailyCounts[dateStr] || 0\n        });\n    }\n    return trendData;\n}\nfunction calculateCompletionRate(totalQuestions, responses) {\n    if (responses.length === 0 || totalQuestions === 0) return 0;\n    let totalAnswered = 0;\n    responses.forEach((response)=>{\n        const answered = response.response_items?.length || 0;\n        totalAnswered += answered / totalQuestions;\n    });\n    return parseFloat((totalAnswered / responses.length * 100).toFixed(1));\n}\nfunction calculateAverageResponseTime(responses) {\n    // Esto asume que tienes un campo de tiempo de inicio y fin\n    // Por ahora, retornar un valor estimado basado en la cantidad de preguntas\n    if (responses.length === 0) return \"0\";\n    const estimatedTimePerQuestion = 15; // segundos por pregunta\n    const avgQuestionsAnswered = responses.reduce((sum, r)=>sum + (r.response_items?.length || 0), 0) / responses.length;\n    const avgSeconds = avgQuestionsAnswered * estimatedTimePerQuestion;\n    const minutes = Math.floor(avgSeconds / 60);\n    return minutes > 0 ? `${minutes}m` : `${Math.round(avgSeconds)}s`;\n}\nfunction calculateMedian(responses) {\n    const ratings = responses.map((r)=>r.value_numeric).filter((r)=>r !== null && r !== undefined).sort((a, b)=>a - b);\n    if (ratings.length === 0) return 0;\n    const middle = Math.floor(ratings.length / 2);\n    if (ratings.length % 2 === 0) {\n        return (ratings[middle - 1] + ratings[middle]) / 2;\n    }\n    return ratings[middle];\n}\nfunction analyzeWordFrequency(texts) {\n    const wordMap = {};\n    const stopWords = new Set([\n        \"el\",\n        \"la\",\n        \"los\",\n        \"las\",\n        \"un\",\n        \"una\",\n        \"de\",\n        \"que\",\n        \"y\",\n        \"en\",\n        \"a\",\n        \"con\"\n    ]);\n    texts.forEach((text)=>{\n        const words = text.toLowerCase().replace(/[^\\w\\sáéíóúñ]/g, \"\").split(/\\s+/).filter((word)=>word.length > 2 && !stopWords.has(word));\n        words.forEach((word)=>{\n            wordMap[word] = (wordMap[word] || 0) + 1;\n        });\n    });\n    return Object.entries(wordMap).sort((a, b)=>b[1] - a[1]).map(([word, count])=>({\n            word,\n            count\n        }));\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9hcHAvYXBpL3N1cnZleXMvW2lkXS9hbmFseXRpY3Mvcm91dGUudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQXdEO0FBQ0Y7QUFFL0MsZUFBZUUsSUFDcEJDLE9BQW9CLEVBQ3BCLEVBQUVDLE1BQU0sRUFBOEI7SUFFdEMsSUFBSTtRQUNGLCtDQUErQztRQUMvQyxNQUFNQyxXQUFXSixtRUFBY0E7UUFFL0IsNkJBQTZCO1FBQzdCLE1BQU0sRUFBRUssTUFBTSxFQUFFQyxJQUFJLEVBQUUsRUFBRUMsT0FBT0MsU0FBUyxFQUFFLEdBQUcsTUFBTUosU0FBU0ssSUFBSSxDQUFDQyxPQUFPO1FBQ3hFLElBQUksQ0FBQ0osUUFBUUUsV0FBVztZQUN0QixPQUFPVCxxREFBWUEsQ0FBQ1ksSUFBSSxDQUFDO2dCQUFFSixPQUFPO1lBQWdCLEdBQUc7Z0JBQUVLLFFBQVE7WUFBSTtRQUNyRTtRQUVBLHNEQUFzRDtRQUN0RCxNQUFNLEVBQUVQLE1BQU1RLE1BQU0sRUFBRU4sT0FBT08sV0FBVyxFQUFFLEdBQUcsTUFBTVYsU0FDaERXLElBQUksQ0FBQyxXQUNMQyxNQUFNLENBQUMsQ0FBQzs7O01BR1QsQ0FBQyxFQUNBQyxFQUFFLENBQUMsTUFBTWQsT0FBT2UsRUFBRSxFQUNsQkQsRUFBRSxDQUFDLFlBQVlYLEtBQUtZLEVBQUUsRUFDdEJDLE1BQU07UUFFVCxJQUFJTCxlQUFlLENBQUNELFFBQVE7WUFDMUIsT0FBT2QscURBQVlBLENBQUNZLElBQUksQ0FBQztnQkFDdkJKLE9BQU87WUFDVCxHQUFHO2dCQUFFSyxRQUFRO1lBQUk7UUFDbkI7UUFFQSxrQ0FBa0M7UUFDbEMsTUFBTSxFQUFFUSxPQUFPQyxjQUFjLEVBQUVkLE9BQU9lLFVBQVUsRUFBRSxHQUFHLE1BQU1sQixTQUN4RFcsSUFBSSxDQUFDLGFBQ0xDLE1BQU0sQ0FBQyxNQUFNO1lBQUVJLE9BQU87WUFBU0csTUFBTTtRQUFLLEdBQzFDTixFQUFFLENBQUMsYUFBYWQsT0FBT2UsRUFBRTtRQUU1QixJ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T0FBTyxDQUFDOEYsU0FDbkI3QixJQUFJLENBQUMsQ0FBQ0MsR0FBR0MsSUFBTUEsQ0FBQyxDQUFDLEVBQUUsR0FBR0QsQ0FBQyxDQUFDLEVBQUUsRUFDMUJuRyxHQUFHLENBQUMsQ0FBQyxDQUFDcUksTUFBTTVLLE1BQU0sR0FBTTtZQUFFNEs7WUFBTTVLO1FBQU07QUFDM0MiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9lbmN1ZXN0YXMtcXIvLi9hcHAvYXBpL3N1cnZleXMvW2lkXS9hbmFseXRpY3Mvcm91dGUudHM/NjM1NCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBOZXh0UmVxdWVzdCwgTmV4dFJlc3BvbnNlIH0gZnJvbSAnbmV4dC9zZXJ2ZXInO1xyXG5pbXBvcnQgeyBzdXBhYmFzZVNlcnZlciB9IGZyb20gJ0AvbGliL3N1cGFiYXNlU2VydmVyJztcclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBHRVQoXHJcbiAgcmVxdWVzdDogTmV4dFJlcXVlc3QsXHJcbiAgeyBwYXJhbXMgfTogeyBwYXJhbXM6IHsgaWQ6IHN0cmluZyB9IH1cclxuKSB7XHJcbiAgdHJ5IHtcclxuICAgIC8vIDEuIENyZWFyIGNsaWVudGUgZGUgU3VwYWJhc2UgY29uIGNvb2tpZXMgU1NSXHJcbiAgICBjb25zdCBzdXBhYmFzZSA9IHN1cGFiYXNlU2VydmVyKCk7XHJcbiAgICBcclxuICAgIC8vIDIuIFZlcmlmaWNhciBhdXRlbnRpY2FjacOzblxyXG4gICAgY29uc3QgeyBkYXRhOiB7IHVzZXIgfSwgZXJyb3I6IGF1dGhFcnJvciB9ID0gYXdhaXQgc3VwYWJhc2UuYXV0aC5nZXRVc2VyKCk7XHJcbiAgICBpZiAoIXVzZXIgfHwgYXV0aEVycm9yKSB7XHJcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IGVycm9yOiAnTm8gYXV0b3JpemFkbycgfSwgeyBzdGF0dXM6IDQwMSB9KTtcclxuICAgIH1cclxuXHJcbiAgICAvLyAzLiBWZXJpZmljYXIgcXVlIGVsIHVzdWFyaW8gZXMgZHVlw7FvIGRlIGxhIGVuY3Vlc3RhXHJcbiAgICBjb25zdCB7IGRhdGE6IHN1cnZleSwgZXJyb3I6IHN1cnZleUVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxyXG4gICAgICAuZnJvbSgnc3VydmV5cycpXHJcbiAgICAgIC5zZWxlY3QoYFxyXG4gICAgICAgICosXHJcbiAgICAgICAgcHJvZmlsZXMhc3VydmV5c19vd25lcl9pZF9ma2V5IChpZCwgZGlzcGxheV9uYW1lKVxyXG4gICAgICBgKVxyXG4gICAgICAuZXEoJ2lkJywgcGFyYW1zLmlkKVxyXG4gICAgICAuZXEoJ293bmVyX2lkJywgdXNlci5pZClcclxuICAgICAgLnNpbmdsZSgpO1xyXG5cclxuICAgIGlmIChzdXJ2ZXlFcnJvciB8fCAhc3VydmV5KSB7XHJcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IFxyXG4gICAgICAgIGVycm9yOiAnRW5jdWVzdGEgbm8gZW5jb250cmFkYSBvIG5vIGF1dG9yaXphZG8nIFxyXG4gICAgICB9LCB7IHN0YXR1czogNDA0IH0pO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIDQuIE9idGVuZXIgZXN0YWTDrXN0aWNhcyBiw6FzaWNhc1xyXG4gICAgY29uc3QgeyBjb3VudDogdG90YWxSZXNwb25zZXMsIGVycm9yOiBjb3VudEVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxyXG4gICAgICAuZnJvbSgncmVzcG9uc2VzJylcclxuICAgICAgLnNlbGVjdCgnaWQnLCB7IGNvdW50OiAnZXhhY3QnLCBoZWFkOiB0cnVlIH0pXHJcbiAgICAgIC5lcSgnc3VydmV5X2lkJywgcGFyYW1zLmlkKTtcclxuXHJcbiAgICBpZiAoY291bnRFcnJvcikge1xyXG4gICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBjb3VudGluZyByZXNwb25zZXM6JywgY291bnRFcnJvcik7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gNS4gT2J0ZW5lciBwcmVndW50YXMgY29uIHN1cyBvcGNpb25lc1xyXG4gICAgY29uc3QgeyBkYXRhOiBxdWVzdGlvbnMsIGVycm9yOiBxdWVzdGlvbnNFcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcclxuICAgICAgLmZyb20oJ3N1cnZleV9xdWVzdGlvbnMnKVxyXG4gICAgICAuc2VsZWN0KGBcclxuICAgICAgICAqLFxyXG4gICAgICAgIHN1cnZleV9vcHRpb25zIChcclxuICAgICAgICAgIGlkLFxyXG4gICAgICAgICAgbGFiZWwsXHJcbiAgICAgICAgICB2YWx1ZSxcclxuICAgICAgICAgIHBvc2l0aW9uXHJcbiAgICAgICAgKVxyXG4gICAgICBgKVxyXG4gICAgICAuZXEoJ3N1cnZleV9pZCcsIHBhcmFtcy5pZClcclxuICAgICAgLm9yZGVyKCdwb3NpdGlvbicsIHsgYXNjZW5kaW5nOiB0cnVlIH0pO1xyXG5cclxuICAgIGlmIChxdWVzdGlvbnNFcnJvcikge1xyXG4gICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBmZXRjaGluZyBxdWVzdGlvbnM6JywgcXVlc3Rpb25zRXJyb3IpO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIDYuIE9idGVuZXIgcmVzcHVlc3RhcyBjb24gbWV0YWRhdG9zXHJcbiAgICBjb25zdCB7IGRhdGE6IHJlc3BvbnNlcywgZXJyb3I6IHJlc3BvbnNlc0Vycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxyXG4gICAgICAuZnJvbSgncmVzcG9uc2VzJylcclxuICAgICAgLnNlbGVjdChgXHJcbiAgICAgICAgaWQsXHJcbiAgICAgICAgc3VibWl0dGVkX2F0LFxyXG4gICAgICAgIG1ldGEsXHJcbiAgICAgICAgcmVzcG9uc2VfaXRlbXMgKFxyXG4gICAgICAgICAgcXVlc3Rpb25faWQsXHJcbiAgICAgICAgICB2YWx1ZV90ZXh0LFxyXG4gICAgICAgICAgdmFsdWVfbnVtZXJpYyxcclxuICAgICAgICAgIHZhbHVlX2pzb25cclxuICAgICAgICApXHJcbiAgICAgIGApXHJcbiAgICAgIC5lcSgnc3VydmV5X2lkJywgcGFyYW1zLmlkKVxyXG4gICAgICAub3JkZXIoJ3N1Ym1pdHRlZF9hdCcsIHsgYXNjZW5kaW5nOiBmYWxzZSB9KTtcclxuXHJcbiAgICBpZiAocmVzcG9uc2VzRXJyb3IpIHtcclxuICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgZmV0Y2hpbmcgcmVzcG9uc2VzOicsIHJlc3BvbnNlc0Vycm9yKTtcclxuICAgIH1cclxuXHJcbiAgICAvLyA3LiBQcm9jZXNhciBkYXRvcyBwYXJhIGNhZGEgcHJlZ3VudGFcclxuICAgIGNvbnN0IHF1ZXN0aW9uc1dpdGhBbmFseXRpY3MgPSBhd2FpdCBwcm9jZXNzUXVlc3Rpb25zQW5hbHl0aWNzKFxyXG4gICAgICBxdWVzdGlvbnMgfHwgW10sXHJcbiAgICAgIHJlc3BvbnNlcyB8fCBbXVxyXG4gICAgKTtcclxuXHJcbiAgICAvLyA4LiBDYWxjdWxhciBlc3RhZMOtc3RpY2FzIGRlIGRpc3Bvc2l0aXZvXHJcbiAgICBjb25zdCBkZXZpY2VTdGF0cyA9IGNhbGN1bGF0ZURldmljZVN0YXRzKHJlc3BvbnNlcyB8fCBbXSk7XHJcblxyXG4gICAgLy8gOS4gQ2FsY3VsYXIgdGFzYSBkZSByZXNwdWVzdGEgZGlhcmlhICjDumx0aW1vcyA3IGTDrWFzKVxyXG4gICAgY29uc3QgcmVzcG9uc2VUcmVuZCA9IGF3YWl0IGNhbGN1bGF0ZVJlc3BvbnNlVHJlbmQoc3VwYWJhc2UsIHBhcmFtcy5pZCk7XHJcblxyXG4gICAgLy8gMTAuIFByZXBhcmFyIHJlc3B1ZXN0YVxyXG4gICAgY29uc3QgcmVzdWx0ID0ge1xyXG4gICAgICBzdWNjZXNzOiB0cnVlLFxyXG4gICAgICBkYXRhOiB7XHJcbiAgICAgICAgc3VydmV5OiB7XHJcbiAgICAgICAgICBpZDogc3VydmV5LmlkLFxyXG4gICAgICAgICAgdGl0bGU6IHN1cnZleS50aXRsZSxcclxuICAgICAgICAgIHN0YXR1czogc3VydmV5LnN0YXR1cyxcclxuICAgICAgICAgIGRlc2NyaXB0aW9uOiBzdXJ2ZXkuZGVzY3JpcHRpb24sXHJcbiAgICAgICAgICBjcmVhdGVkX2F0OiBzdXJ2ZXkuY3JlYXRlZF9hdCxcclxuICAgICAgICAgIHB1Ymxpc2hlZF9hdDogc3VydmV5LnB1Ymxpc2hfYXQsXHJcbiAgICAgICAgICB0b3RhbF9yZXNwb25zZXM6IHRvdGFsUmVzcG9uc2VzIHx8IDBcclxuICAgICAgICB9LFxyXG4gICAgICAgIHN1bW1hcnk6IHtcclxuICAgICAgICAgIHRvdGFsX3Jlc3BvbnNlczogdG90YWxSZXNwb25zZXMgfHwgMCxcclxuICAgICAgICAgIGNvbXBsZXRpb25fcmF0ZTogY2FsY3VsYXRlQ29tcGxldGlvblJhdGUocXVlc3Rpb25zPy5sZW5ndGggfHwgMCwgcmVzcG9uc2VzIHx8IFtdKSxcclxuICAgICAgICAgIGF2Z19yZXNwb25zZV90aW1lOiBjYWxjdWxhdGVBdmVyYWdlUmVzcG9uc2VUaW1lKHJlc3BvbnNlcyB8fCBbXSksXHJcbiAgICAgICAgICBkZXZpY2Vfc3RhdHM6IGRldmljZVN0YXRzLFxyXG4gICAgICAgICAgcmVzcG9uc2VfdHJlbmQ6IHJlc3BvbnNlVHJlbmRcclxuICAgICAgICB9LFxyXG4gICAgICAgIHF1ZXN0aW9uczogcXVlc3Rpb25zV2l0aEFuYWx5dGljcyxcclxuICAgICAgICByYXdfcmVzcG9uc2VzX2NvdW50OiByZXNwb25zZXM/Lmxlbmd0aCB8fCAwXHJcbiAgICAgIH1cclxuICAgIH07XHJcblxyXG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHJlc3VsdCk7XHJcblxyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciBlbiBhbmFseXRpY3MgZW5kcG9pbnQ6JywgZXJyb3IpO1xyXG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgXHJcbiAgICAgIGVycm9yOiAnRXJyb3IgaW50ZXJubyBkZWwgc2Vydmlkb3InLFxyXG4gICAgICBkZXRhaWxzOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdVbmtub3duIGVycm9yJ1xyXG4gICAgfSwgeyBzdGF0dXM6IDUwMCB9KTtcclxuICB9XHJcbn1cclxuXHJcbi8vIEhlbHBlciBmdW5jdGlvbnMgKGxhcyBtaXNtYXMgcXVlIGFudGVzLCBwZXJvIGNvbiB0aXBvcyBtZWpvcmFkb3MpXHJcbmFzeW5jIGZ1bmN0aW9uIHByb2Nlc3NRdWVzdGlvbnNBbmFseXRpY3MocXVlc3Rpb25zOiBhbnlbXSwgcmVzcG9uc2VzOiBhbnlbXSkge1xyXG4gIC8vIFByb2Nlc2FyIGNhZGEgcHJlZ3VudGFcclxuICByZXR1cm4gUHJvbWlzZS5hbGwoXHJcbiAgICBxdWVzdGlvbnMubWFwKGFzeW5jIChxdWVzdGlvbikgPT4ge1xyXG4gICAgICAvLyBGaWx0cmFyIHJlc3B1ZXN0YXMgcGFyYSBlc3RhIHByZWd1bnRhXHJcbiAgICAgIGNvbnN0IHF1ZXN0aW9uUmVzcG9uc2VzID0gcmVzcG9uc2VzLmZsYXRNYXAoKHI6IGFueSkgPT4gXHJcbiAgICAgICAgci5yZXNwb25zZV9pdGVtcz8uZmlsdGVyKChyaTogYW55KSA9PiByaS5xdWVzdGlvbl9pZCA9PT0gcXVlc3Rpb24uaWQpIHx8IFtdXHJcbiAgICAgICk7XHJcblxyXG4gICAgICBsZXQgYW5hbHl0aWNzRGF0YTtcclxuICAgICAgXHJcbiAgICAgIHN3aXRjaCAocXVlc3Rpb24udHlwZSkge1xyXG4gICAgICAgIGNhc2UgJ3NpbmdsZSc6XHJcbiAgICAgICAgICBhbmFseXRpY3NEYXRhID0gcHJvY2Vzc1NpbmdsZUNob2ljZUFuYWx5dGljcyhxdWVzdGlvbiwgcXVlc3Rpb25SZXNwb25zZXMpO1xyXG4gICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgY2FzZSAnbXVsdGlwbGUnOlxyXG4gICAgICAgICAgYW5hbHl0aWNzRGF0YSA9IHByb2Nlc3NNdWx0aXBsZUNob2ljZUFuYWx5dGljcyhxdWVzdGlvbiwgcXVlc3Rpb25SZXNwb25zZXMpO1xyXG4gICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgY2FzZSAnbGlrZXJ0JzpcclxuICAgICAgICAgIGFuYWx5dGljc0RhdGEgPSBwcm9jZXNzTGlrZXJ0QW5hbHl0aWNzKHF1ZXN0aW9uLCBxdWVzdGlvblJlc3BvbnNlcyk7XHJcbiAgICAgICAgICBicmVhaztcclxuICAgICAgICBjYXNlICd0ZXh0JzpcclxuICAgICAgICAgIGFuYWx5dGljc0RhdGEgPSBwcm9jZXNzVGV4dEFuYWx5dGljcyhxdWVzdGlvblJlc3BvbnNlcyk7XHJcbiAgICAgICAgICBicmVhaztcclxuICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgYW5hbHl0aWNzRGF0YSA9IHsgdHlwZTogcXVlc3Rpb24udHlwZSwgdW5zdXBwb3J0ZWQ6IHRydWUgfTtcclxuICAgICAgfVxyXG5cclxuICAgICAgcmV0dXJuIHtcclxuICAgICAgICBpZDogcXVlc3Rpb24uaWQsXHJcbiAgICAgICAgcXVlc3Rpb25fdGV4dDogcXVlc3Rpb24ucXVlc3Rpb25fdGV4dCxcclxuICAgICAgICB0eXBlOiBxdWVzdGlvbi50eXBlLFxyXG4gICAgICAgIHJlcXVpcmVkOiBxdWVzdGlvbi5yZXF1aXJlZCxcclxuICAgICAgICBwb3NpdGlvbjogcXVlc3Rpb24ucG9zaXRpb24sXHJcbiAgICAgICAgcmVzcG9uc2VfY291bnQ6IHF1ZXN0aW9uUmVzcG9uc2VzLmxlbmd0aCxcclxuICAgICAgICBhbmFseXRpY3M6IGFuYWx5dGljc0RhdGEsXHJcbiAgICAgICAgb3B0aW9uczogcXVlc3Rpb24uc3VydmV5X29wdGlvbnMgfHwgW11cclxuICAgICAgfTtcclxuICAgIH0pXHJcbiAgKTtcclxufVxyXG5cclxuZnVuY3Rpb24gcHJvY2Vzc1NpbmdsZUNob2ljZUFuYWx5dGljcyhxdWVzdGlvbjogYW55LCByZXNwb25zZXM6IGFueVtdKSB7XHJcbiAgY29uc3Qgb3B0aW9uQ291bnRzOiBSZWNvcmQ8c3RyaW5nLCBudW1iZXI+ID0ge307XHJcbiAgXHJcbiAgLy8gSW5pY2lhbGl6YXIgY29uIG9wY2lvbmVzIGRlZmluaWRhc1xyXG4gIGlmIChxdWVzdGlvbi5zdXJ2ZXlfb3B0aW9ucyAmJiBxdWVzdGlvbi5zdXJ2ZXlfb3B0aW9ucy5sZW5ndGggPiAwKSB7XHJcbiAgICBxdWVzdGlvbi5zdXJ2ZXlfb3B0aW9ucy5mb3JFYWNoKChvcHQ6IGFueSkgPT4ge1xyXG4gICAgICBvcHRpb25Db3VudHNbb3B0LmxhYmVsIHx8IG9wdC52YWx1ZSB8fCAnJ10gPSAwO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICAvLyBDb250YXIgcmVzcHVlc3Rhc1xyXG4gIHJlc3BvbnNlcy5mb3JFYWNoKHJlc3BvbnNlID0+IHtcclxuICAgIGlmIChyZXNwb25zZS52YWx1ZV90ZXh0KSB7XHJcbiAgICAgIGNvbnN0IHZhbHVlID0gcmVzcG9uc2UudmFsdWVfdGV4dDtcclxuICAgICAgb3B0aW9uQ291bnRzW3ZhbHVlXSA9IChvcHRpb25Db3VudHNbdmFsdWVdIHx8IDApICsgMTtcclxuICAgIH1cclxuICB9KTtcclxuXHJcbiAgY29uc3QgdG90YWwgPSByZXNwb25zZXMubGVuZ3RoO1xyXG4gIGNvbnN0IGNoYXJ0RGF0YSA9IE9iamVjdC5lbnRyaWVzKG9wdGlvbkNvdW50cykubWFwKChbb3B0aW9uLCBjb3VudF0pID0+ICh7XHJcbiAgICBvcHRpb24sXHJcbiAgICBjb3VudCxcclxuICAgIHBlcmNlbnRhZ2U6IHRvdGFsID4gMCA/IHBhcnNlRmxvYXQoKGNvdW50IC8gdG90YWwgKiAxMDApLnRvRml4ZWQoMSkpIDogMFxyXG4gIH0pKTtcclxuXHJcbiAgcmV0dXJuIHtcclxuICAgIGNoYXJ0X2RhdGE6IGNoYXJ0RGF0YSxcclxuICAgIHRvdGFsX3Jlc3BvbnNlczogdG90YWwsXHJcbiAgICBtb3N0X3NlbGVjdGVkOiBjaGFydERhdGEubGVuZ3RoID4gMCBcclxuICAgICAgPyBjaGFydERhdGEucmVkdWNlKChtYXgsIGl0ZW0pID0+IGl0ZW0uY291bnQgPiBtYXguY291bnQgPyBpdGVtIDogbWF4KVxyXG4gICAgICA6IG51bGxcclxuICB9O1xyXG59XHJcblxyXG5mdW5jdGlvbiBwcm9jZXNzTXVsdGlwbGVDaG9pY2VBbmFseXRpY3MocXVlc3Rpb246IGFueSwgcmVzcG9uc2VzOiBhbnlbXSkge1xyXG4gIGNvbnN0IG9wdGlvbkNvdW50czogUmVjb3JkPHN0cmluZywgbnVtYmVyPiA9IHt9O1xyXG4gIGxldCB0b3RhbFNlbGVjdGlvbnMgPSAwO1xyXG5cclxuICAvLyBJbmljaWFsaXphciBjb24gb3BjaW9uZXMgZGVmaW5pZGFzXHJcbiAgaWYgKHF1ZXN0aW9uLnN1cnZleV9vcHRpb25zICYmIHF1ZXN0aW9uLnN1cnZleV9vcHRpb25zLmxlbmd0aCA+IDApIHtcclxuICAgIHF1ZXN0aW9uLnN1cnZleV9vcHRpb25zLmZvckVhY2goKG9wdDogYW55KSA9PiB7XHJcbiAgICAgIG9wdGlvbkNvdW50c1tvcHQubGFiZWwgfHwgb3B0LnZhbHVlIHx8ICcnXSA9IDA7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIC8vIENvbnRhciBzZWxlY2Npb25lcyAocHVlZGVuIHNlciBtw7psdGlwbGVzIHBvciByZXNwdWVzdGEpXHJcbiAgcmVzcG9uc2VzLmZvckVhY2gocmVzcG9uc2UgPT4ge1xyXG4gICAgaWYgKHJlc3BvbnNlLnZhbHVlX2pzb24gJiYgQXJyYXkuaXNBcnJheShyZXNwb25zZS52YWx1ZV9qc29uKSkge1xyXG4gICAgICByZXNwb25zZS52YWx1ZV9qc29uLmZvckVhY2goKHZhbHVlOiBzdHJpbmcpID0+IHtcclxuICAgICAgICBpZiAob3B0aW9uQ291bnRzW3ZhbHVlXSAhPT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICBvcHRpb25Db3VudHNbdmFsdWVdKys7XHJcbiAgICAgICAgICB0b3RhbFNlbGVjdGlvbnMrKztcclxuICAgICAgICB9XHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG4gIH0pO1xyXG5cclxuICBjb25zdCB0b3RhbFJlc3BvbnNlcyA9IHJlc3BvbnNlcy5sZW5ndGg7XHJcbiAgY29uc3QgY2hhcnREYXRhID0gT2JqZWN0LmVudHJpZXMob3B0aW9uQ291bnRzKS5tYXAoKFtvcHRpb24sIGNvdW50XSkgPT4gKHtcclxuICAgIG9wdGlvbixcclxuICAgIGNvdW50LFxyXG4gICAgc2VsZWN0aW9uX3BlcmNlbnRhZ2U6IHRvdGFsU2VsZWN0aW9ucyA+IDAgPyBwYXJzZUZsb2F0KChjb3VudCAvIHRvdGFsU2VsZWN0aW9ucyAqIDEwMCkudG9GaXhlZCgxKSkgOiAwLFxyXG4gICAgcmVzcG9uZGVudF9wZXJjZW50YWdlOiB0b3RhbFJlc3BvbnNlcyA+IDAgPyBwYXJzZUZsb2F0KChjb3VudCAvIHRvdGFsUmVzcG9uc2VzICogMTAwKS50b0ZpeGVkKDEpKSA6IDBcclxuICB9KSk7XHJcblxyXG4gIHJldHVybiB7XHJcbiAgICBjaGFydF9kYXRhOiBjaGFydERhdGEsXHJcbiAgICB0b3RhbF9yZXNwb25zZXM6IHRvdGFsUmVzcG9uc2VzLFxyXG4gICAgdG90YWxfc2VsZWN0aW9uczogdG90YWxTZWxlY3Rpb25zLFxyXG4gICAgYXZnX3NlbGVjdGlvbnNfcGVyX3Jlc3BvbnNlOiB0b3RhbFJlc3BvbnNlcyA+IDAgPyBwYXJzZUZsb2F0KCh0b3RhbFNlbGVjdGlvbnMgLyB0b3RhbFJlc3BvbnNlcykudG9GaXhlZCgyKSkgOiAwLFxyXG4gICAgbW9zdF9zZWxlY3RlZDogY2hhcnREYXRhLmxlbmd0aCA+IDAgXHJcbiAgICAgID8gY2hhcnREYXRhLnJlZHVjZSgobWF4LCBpdGVtKSA9PiBpdGVtLmNvdW50ID4gbWF4LmNvdW50ID8gaXRlbSA6IG1heClcclxuICAgICAgOiBudWxsXHJcbiAgfTtcclxufVxyXG5cclxuZnVuY3Rpb24gcHJvY2Vzc0xpa2VydEFuYWx5dGljcyhxdWVzdGlvbjogYW55LCByZXNwb25zZXM6IGFueVtdKSB7XHJcbiAgY29uc3QgcmF0aW5nQ291bnRzOiBSZWNvcmQ8bnVtYmVyLCBudW1iZXI+ID0ge307XHJcbiAgY29uc3QgcmF0aW5ncyA9IFsxLCAyLCAzLCA0LCA1LCA2LCA3XTsgLy8gRXNjYWxhIGNvbcO6blxyXG5cclxuICAvLyBJbmljaWFsaXphciBjb250YWRvcmVzXHJcbiAgcmF0aW5ncy5mb3JFYWNoKHJhdGluZyA9PiB7XHJcbiAgICByYXRpbmdDb3VudHNbcmF0aW5nXSA9IDA7XHJcbiAgfSk7XHJcblxyXG4gIC8vIENvbnRhciByZXNwdWVzdGFzXHJcbiAgbGV0IHRvdGFsID0gMDtcclxuICBsZXQgc3VtID0gMDtcclxuICBcclxuICByZXNwb25zZXMuZm9yRWFjaChyZXNwb25zZSA9PiB7XHJcbiAgICBpZiAocmVzcG9uc2UudmFsdWVfbnVtZXJpYyAhPT0gbnVsbCAmJiByZXNwb25zZS52YWx1ZV9udW1lcmljICE9PSB1bmRlZmluZWQpIHtcclxuICAgICAgY29uc3QgcmF0aW5nID0gTnVtYmVyKHJlc3BvbnNlLnZhbHVlX251bWVyaWMpO1xyXG4gICAgICBpZiAocmF0aW5ncy5pbmNsdWRlcyhyYXRpbmcpKSB7XHJcbiAgICAgICAgcmF0aW5nQ291bnRzW3JhdGluZ10rKztcclxuICAgICAgICB0b3RhbCsrO1xyXG4gICAgICAgIHN1bSArPSByYXRpbmc7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICB9KTtcclxuXHJcbiAgY29uc3QgY2hhcnREYXRhID0gT2JqZWN0LmVudHJpZXMocmF0aW5nQ291bnRzKS5tYXAoKFtyYXRpbmcsIGNvdW50XSkgPT4gKHtcclxuICAgIHJhdGluZzogTnVtYmVyKHJhdGluZyksXHJcbiAgICBjb3VudCxcclxuICAgIHBlcmNlbnRhZ2U6IHRvdGFsID4gMCA/IHBhcnNlRmxvYXQoKGNvdW50IC8gdG90YWwgKiAxMDApLnRvRml4ZWQoMSkpIDogMFxyXG4gIH0pKTtcclxuXHJcbiAgcmV0dXJuIHtcclxuICAgIGNoYXJ0X2RhdGE6IGNoYXJ0RGF0YSxcclxuICAgIHRvdGFsX3Jlc3BvbnNlczogdG90YWwsXHJcbiAgICBhdmVyYWdlX3JhdGluZzogdG90YWwgPiAwID8gcGFyc2VGbG9hdCgoc3VtIC8gdG90YWwpLnRvRml4ZWQoMikpIDogMCxcclxuICAgIG1lZGlhbl9yYXRpbmc6IGNhbGN1bGF0ZU1lZGlhbihyZXNwb25zZXMpLFxyXG4gICAgZGlzdHJpYnV0aW9uOiBjaGFydERhdGFcclxuICB9O1xyXG59XHJcblxyXG5mdW5jdGlvbiBwcm9jZXNzVGV4dEFuYWx5dGljcyhyZXNwb25zZXM6IGFueVtdKSB7XHJcbiAgY29uc3QgdGV4dFJlc3BvbnNlcyA9IHJlc3BvbnNlc1xyXG4gICAgLmZpbHRlcihyID0+IHIudmFsdWVfdGV4dCAmJiByLnZhbHVlX3RleHQudHJpbSgpLmxlbmd0aCA+IDApXHJcbiAgICAubWFwKHIgPT4gKHtcclxuICAgICAgdGV4dDogci52YWx1ZV90ZXh0LFxyXG4gICAgICBsZW5ndGg6IHIudmFsdWVfdGV4dC5sZW5ndGgsXHJcbiAgICAgIHdvcmRfY291bnQ6IHIudmFsdWVfdGV4dC5zcGxpdCgvXFxzKy8pLmZpbHRlcigodzogc3RyaW5nKSA9PiB3Lmxlbmd0aCA+IDApLmxlbmd0aFxyXG4gICAgfSkpO1xyXG5cclxuICAvLyBBbsOhbGlzaXMgYsOhc2ljbyBkZSB0ZXh0b1xyXG4gIGNvbnN0IHdvcmRGcmVxdWVuY2llcyA9IGFuYWx5emVXb3JkRnJlcXVlbmN5KHRleHRSZXNwb25zZXMubWFwKChyOiBhbnkpID0+IHIudGV4dCkpO1xyXG4gIGNvbnN0IGF2Z0xlbmd0aCA9IHRleHRSZXNwb25zZXMubGVuZ3RoID4gMCBcclxuICAgID8gdGV4dFJlc3BvbnNlcy5yZWR1Y2UoKHN1bTogbnVtYmVyLCByOiBhbnkpID0+IHN1bSArIHIubGVuZ3RoLCAwKSAvIHRleHRSZXNwb25zZXMubGVuZ3RoIFxyXG4gICAgOiAwO1xyXG4gIGNvbnN0IGF2Z1dvcmRDb3VudCA9IHRleHRSZXNwb25zZXMubGVuZ3RoID4gMCBcclxuICAgID8gdGV4dFJlc3BvbnNlcy5yZWR1Y2UoKHN1bTogbnVtYmVyLCByOiBhbnkpID0+IHN1bSArIHIud29yZF9jb3VudCwgMCkgLyB0ZXh0UmVzcG9uc2VzLmxlbmd0aCBcclxuICAgIDogMDtcclxuXHJcbiAgcmV0dXJuIHtcclxuICAgIHRvdGFsX3Jlc3BvbnNlczogdGV4dFJlc3BvbnNlcy5sZW5ndGgsXHJcbiAgICBzYW1wbGVfcmVzcG9uc2VzOiB0ZXh0UmVzcG9uc2VzLnNsaWNlKDAsIDEwKSwgLy8gTW9zdHJhciBzb2xvIDEwXHJcbiAgICB3b3JkX2ZyZXF1ZW5jaWVzOiB3b3JkRnJlcXVlbmNpZXMuc2xpY2UoMCwgMjApLCAvLyBUb3AgMjAgcGFsYWJyYXNcclxuICAgIGF2ZXJhZ2VfbGVuZ3RoOiBNYXRoLnJvdW5kKGF2Z0xlbmd0aCksXHJcbiAgICBhdmVyYWdlX3dvcmRfY291bnQ6IE1hdGgucm91bmQoYXZnV29yZENvdW50KSxcclxuICAgIHNob3J0ZXN0X3Jlc3BvbnNlOiB0ZXh0UmVzcG9uc2VzLmxlbmd0aCA+IDAgXHJcbiAgICAgID8gdGV4dFJlc3BvbnNlcy5yZWR1Y2UoKG1pbjogYW55LCByOiBhbnkpID0+IHIubGVuZ3RoIDwgbWluLmxlbmd0aCA/IHIgOiBtaW4sIHRleHRSZXNwb25zZXNbMF0pXHJcbiAgICAgIDogbnVsbCxcclxuICAgIGxvbmdlc3RfcmVzcG9uc2U6IHRleHRSZXNwb25zZXMubGVuZ3RoID4gMCBcclxuICAgICAgPyB0ZXh0UmVzcG9uc2VzLnJlZHVjZSgobWF4OiBhbnksIHI6IGFueSkgPT4gci5sZW5ndGggPiBtYXgubGVuZ3RoID8gciA6IG1heCwgdGV4dFJlc3BvbnNlc1swXSlcclxuICAgICAgOiBudWxsXHJcbiAgfTtcclxufVxyXG5cclxuZnVuY3Rpb24gY2FsY3VsYXRlRGV2aWNlU3RhdHMocmVzcG9uc2VzOiBhbnlbXSkge1xyXG4gIGNvbnN0IHN0YXRzID0ge1xyXG4gICAgbW9iaWxlOiAwLFxyXG4gICAgZGVza3RvcDogMCxcclxuICAgIHRhYmxldDogMCxcclxuICAgIGJyb3dzZXJzOiB7fSBhcyBSZWNvcmQ8c3RyaW5nLCBudW1iZXI+LFxyXG4gICAgb3BlcmF0aW5nX3N5c3RlbXM6IHt9IGFzIFJlY29yZDxzdHJpbmcsIG51bWJlcj4sXHJcbiAgICB0b3RhbDogcmVzcG9uc2VzLmxlbmd0aFxyXG4gIH07XHJcblxyXG4gIHJlc3BvbnNlcy5mb3JFYWNoKHJlc3BvbnNlID0+IHtcclxuICAgIGNvbnN0IG1ldGEgPSByZXNwb25zZS5tZXRhIHx8IHt9O1xyXG4gICAgXHJcbiAgICAvLyBEZXRlY3RhciBkaXNwb3NpdGl2b1xyXG4gICAgaWYgKG1ldGEuaXNfbW9iaWxlKSB7XHJcbiAgICAgIHN0YXRzLm1vYmlsZSsrO1xyXG4gICAgfSBlbHNlIGlmIChtZXRhLmlzX3RhYmxldCkge1xyXG4gICAgICBzdGF0cy50YWJsZXQrKztcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHN0YXRzLmRlc2t0b3ArKztcclxuICAgIH1cclxuXHJcbiAgICAvLyBOYXZlZ2Fkb3JcclxuICAgIGlmIChtZXRhLmJyb3dzZXIpIHtcclxuICAgICAgY29uc3QgYnJvd3NlciA9IG1ldGEuYnJvd3Nlci5zcGxpdCgnICcpWzBdOyAvLyBUb21hciBzb2xvIGVsIG5vbWJyZSBwcmluY2lwYWxcclxuICAgICAgc3RhdHMuYnJvd3NlcnNbYnJvd3Nlcl0gPSAoc3RhdHMuYnJvd3NlcnNbYnJvd3Nlcl0gfHwgMCkgKyAxO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIFNpc3RlbWEgb3BlcmF0aXZvXHJcbiAgICBpZiAobWV0YS5vcykge1xyXG4gICAgICBzdGF0cy5vcGVyYXRpbmdfc3lzdGVtc1ttZXRhLm9zXSA9IChzdGF0cy5vcGVyYXRpbmdfc3lzdGVtc1ttZXRhLm9zXSB8fCAwKSArIDE7XHJcbiAgICB9XHJcbiAgfSk7XHJcblxyXG4gIGNvbnN0IHRvdGFsID0gc3RhdHMudG90YWwgfHwgMTsgLy8gRXZpdGFyIGRpdmlzacOzbiBwb3IgMFxyXG5cclxuICByZXR1cm4ge1xyXG4gICAgLi4uc3RhdHMsXHJcbiAgICBtb2JpbGVfcGVyY2VudGFnZTogdG90YWwgPiAwID8gcGFyc2VGbG9hdCgoKHN0YXRzLm1vYmlsZSAvIHRvdGFsKSAqIDEwMCkudG9GaXhlZCgxKSkgOiAwLFxyXG4gICAgZGVza3RvcF9wZXJjZW50YWdlOiB0b3RhbCA+IDAgPyBwYXJzZUZsb2F0KCgoc3RhdHMuZGVza3RvcCAvIHRvdGFsKSAqIDEwMCkudG9GaXhlZCgxKSkgOiAwLFxyXG4gICAgdGFibGV0X3BlcmNlbnRhZ2U6IHRvdGFsID4gMCA/IHBhcnNlRmxvYXQoKChzdGF0cy50YWJsZXQgLyB0b3RhbCkgKiAxMDApLnRvRml4ZWQoMSkpIDogMCxcclxuICAgIHRvcF9icm93c2VyOiBPYmplY3QuZW50cmllcyhzdGF0cy5icm93c2Vycykuc29ydCgoYSwgYikgPT4gYlsxXSAtIGFbMV0pWzBdPy5bMF0gfHwgJ0Rlc2Nvbm9jaWRvJyxcclxuICAgIHRvcF9vczogT2JqZWN0LmVudHJpZXMoc3RhdHMub3BlcmF0aW5nX3N5c3RlbXMpLnNvcnQoKGEsIGIpID0+IGJbMV0gLSBhWzFdKVswXT8uWzBdIHx8ICdEZXNjb25vY2lkbydcclxuICB9O1xyXG59XHJcblxyXG5hc3luYyBmdW5jdGlvbiBjYWxjdWxhdGVSZXNwb25zZVRyZW5kKHN1cGFiYXNlOiBhbnksIHN1cnZleUlkOiBzdHJpbmcpIHtcclxuICBjb25zdCBzZXZlbkRheXNBZ28gPSBuZXcgRGF0ZSgpO1xyXG4gIHNldmVuRGF5c0Fnby5zZXREYXRlKHNldmVuRGF5c0Fnby5nZXREYXRlKCkgLSA3KTtcclxuXHJcbiAgY29uc3QgeyBkYXRhOiBkYWlseVJlc3BvbnNlcywgZXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXHJcbiAgICAuZnJvbSgncmVzcG9uc2VzJylcclxuICAgIC5zZWxlY3QoJ3N1Ym1pdHRlZF9hdCcpXHJcbiAgICAuZXEoJ3N1cnZleV9pZCcsIHN1cnZleUlkKVxyXG4gICAgLmd0ZSgnc3VibWl0dGVkX2F0Jywgc2V2ZW5EYXlzQWdvLnRvSVNPU3RyaW5nKCkpXHJcbiAgICAub3JkZXIoJ3N1Ym1pdHRlZF9hdCcsIHsgYXNjZW5kaW5nOiB0cnVlIH0pO1xyXG5cclxuICBpZiAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZldGNoaW5nIHJlc3BvbnNlIHRyZW5kOicsIGVycm9yKTtcclxuICAgIHJldHVybiBbXTtcclxuICB9XHJcblxyXG4gIC8vIEFncnVwYXIgcG9yIGTDrWFcclxuICBjb25zdCBkYWlseUNvdW50czogUmVjb3JkPHN0cmluZywgbnVtYmVyPiA9IHt9O1xyXG4gIFxyXG4gIGRhaWx5UmVzcG9uc2VzPy5mb3JFYWNoKChyZXNwb25zZTogYW55KSA9PiB7XHJcbiAgICBjb25zdCBkYXRlID0gbmV3IERhdGUocmVzcG9uc2Uuc3VibWl0dGVkX2F0KS50b0lTT1N0cmluZygpLnNwbGl0KCdUJylbMF07XHJcbiAgICBkYWlseUNvdW50c1tkYXRlXSA9IChkYWlseUNvdW50c1tkYXRlXSB8fCAwKSArIDE7XHJcbiAgfSk7XHJcblxyXG4gIC8vIFJlbGxlbmFyIGTDrWFzIHNpbiByZXNwdWVzdGFzXHJcbiAgY29uc3QgdHJlbmREYXRhID0gW107XHJcbiAgZm9yIChsZXQgaSA9IDY7IGkgPj0gMDsgaS0tKSB7XHJcbiAgICBjb25zdCBkYXRlID0gbmV3IERhdGUoKTtcclxuICAgIGRhdGUuc2V0RGF0ZShkYXRlLmdldERhdGUoKSAtIGkpO1xyXG4gICAgY29uc3QgZGF0ZVN0ciA9IGRhdGUudG9JU09TdHJpbmcoKS5zcGxpdCgnVCcpWzBdO1xyXG4gICAgdHJlbmREYXRhLnB1c2goe1xyXG4gICAgICBkYXRlOiBkYXRlU3RyLFxyXG4gICAgICBjb3VudDogZGFpbHlDb3VudHNbZGF0ZVN0cl0gfHwgMFxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICByZXR1cm4gdHJlbmREYXRhO1xyXG59XHJcblxyXG5mdW5jdGlvbiBjYWxjdWxhdGVDb21wbGV0aW9uUmF0ZSh0b3RhbFF1ZXN0aW9uczogbnVtYmVyLCByZXNwb25zZXM6IGFueVtdKSB7XHJcbiAgaWYgKHJlc3BvbnNlcy5sZW5ndGggPT09IDAgfHwgdG90YWxRdWVzdGlvbnMgPT09IDApIHJldHVybiAwO1xyXG4gIFxyXG4gIGxldCB0b3RhbEFuc3dlcmVkID0gMDtcclxuICByZXNwb25zZXMuZm9yRWFjaCgocmVzcG9uc2U6IGFueSkgPT4ge1xyXG4gICAgY29uc3QgYW5zd2VyZWQgPSByZXNwb25zZS5yZXNwb25zZV9pdGVtcz8ubGVuZ3RoIHx8IDA7XHJcbiAgICB0b3RhbEFuc3dlcmVkICs9IGFuc3dlcmVkIC8gdG90YWxRdWVzdGlvbnM7XHJcbiAgfSk7XHJcbiAgXHJcbiAgcmV0dXJuIHBhcnNlRmxvYXQoKCh0b3RhbEFuc3dlcmVkIC8gcmVzcG9uc2VzLmxlbmd0aCkgKiAxMDApLnRvRml4ZWQoMSkpO1xyXG59XHJcblxyXG5mdW5jdGlvbiBjYWxjdWxhdGVBdmVyYWdlUmVzcG9uc2VUaW1lKHJlc3BvbnNlczogYW55W10pIHtcclxuICAvLyBFc3RvIGFzdW1lIHF1ZSB0aWVuZXMgdW4gY2FtcG8gZGUgdGllbXBvIGRlIGluaWNpbyB5IGZpblxyXG4gIC8vIFBvciBhaG9yYSwgcmV0b3JuYXIgdW4gdmFsb3IgZXN0aW1hZG8gYmFzYWRvIGVuIGxhIGNhbnRpZGFkIGRlIHByZWd1bnRhc1xyXG4gIGlmIChyZXNwb25zZXMubGVuZ3RoID09PSAwKSByZXR1cm4gJzAnO1xyXG4gIFxyXG4gIGNvbnN0IGVzdGltYXRlZFRpbWVQZXJRdWVzdGlvbiA9IDE1OyAvLyBzZWd1bmRvcyBwb3IgcHJlZ3VudGFcclxuICBjb25zdCBhdmdRdWVzdGlvbnNBbnN3ZXJlZCA9IHJlc3BvbnNlcy5yZWR1Y2UoKHN1bTogbnVtYmVyLCByOiBhbnkpID0+IFxyXG4gICAgc3VtICsgKHIucmVzcG9uc2VfaXRlbXM/Lmxlbmd0aCB8fCAwKSwgMCkgLyByZXNwb25zZXMubGVuZ3RoO1xyXG4gIFxyXG4gIGNvbnN0IGF2Z1NlY29uZHMgPSBhdmdRdWVzdGlvbnNBbnN3ZXJlZCAqIGVzdGltYXRlZFRpbWVQZXJRdWVzdGlvbjtcclxuICBjb25zdCBtaW51dGVzID0gTWF0aC5mbG9vcihhdmdTZWNvbmRzIC8gNjApO1xyXG4gIFxyXG4gIHJldHVybiBtaW51dGVzID4gMCA/IGAke21pbnV0ZXN9bWAgOiBgJHtNYXRoLnJvdW5kKGF2Z1NlY29uZHMpfXNgO1xyXG59XHJcblxyXG5mdW5jdGlvbiBjYWxjdWxhdGVNZWRpYW4ocmVzcG9uc2VzOiBhbnlbXSkge1xyXG4gIGNvbnN0IHJhdGluZ3MgPSByZXNwb25zZXNcclxuICAgIC5tYXAoKHI6IGFueSkgPT4gci52YWx1ZV9udW1lcmljKVxyXG4gICAgLmZpbHRlcigocjogYW55KSA9PiByICE9PSBudWxsICYmIHIgIT09IHVuZGVmaW5lZClcclxuICAgIC5zb3J0KChhOiBudW1iZXIsIGI6IG51bWJlcikgPT4gYSAtIGIpO1xyXG4gIFxyXG4gIGlmIChyYXRpbmdzLmxlbmd0aCA9PT0gMCkgcmV0dXJuIDA7XHJcbiAgXHJcbiAgY29uc3QgbWlkZGxlID0gTWF0aC5mbG9vcihyYXRpbmdzLmxlbmd0aCAvIDIpO1xyXG4gIGlmIChyYXRpbmdzLmxlbmd0aCAlIDIgPT09IDApIHtcclxuICAgIHJldHVybiAocmF0aW5nc1ttaWRkbGUgLSAxXSArIHJhdGluZ3NbbWlkZGxlXSkgLyAyO1xyXG4gIH1cclxuICByZXR1cm4gcmF0aW5nc1ttaWRkbGVdO1xyXG59XHJcblxyXG5mdW5jdGlvbiBhbmFseXplV29yZEZyZXF1ZW5jeSh0ZXh0czogc3RyaW5nW10pIHtcclxuICBjb25zdCB3b3JkTWFwOiBSZWNvcmQ8c3RyaW5nLCBudW1iZXI+ID0ge307XHJcbiAgY29uc3Qgc3RvcFdvcmRzID0gbmV3IFNldChbJ2VsJywgJ2xhJywgJ2xvcycsICdsYXMnLCAndW4nLCAndW5hJywgJ2RlJywgJ3F1ZScsICd5JywgJ2VuJywgJ2EnLCAnY29uJ10pO1xyXG4gIFxyXG4gIHRleHRzLmZvckVhY2godGV4dCA9PiB7XHJcbiAgICBjb25zdCB3b3JkcyA9IHRleHQudG9Mb3dlckNhc2UoKVxyXG4gICAgICAucmVwbGFjZSgvW15cXHdcXHPDocOpw63Ds8O6w7FdL2csICcnKVxyXG4gICAgICAuc3BsaXQoL1xccysvKVxyXG4gICAgICAuZmlsdGVyKHdvcmQgPT4gd29yZC5sZW5ndGggPiAyICYmICFzdG9wV29yZHMuaGFzKHdvcmQpKTtcclxuICAgIFxyXG4gICAgd29yZHMuZm9yRWFjaCh3b3JkID0+IHtcclxuICAgICAgd29yZE1hcFt3b3JkXSA9ICh3b3JkTWFwW3dvcmRdIHx8IDApICsgMTtcclxuICAgIH0pO1xyXG4gIH0pO1xyXG4gIFxyXG4gIHJldHVybiBPYmplY3QuZW50cmllcyh3b3JkTWFwKVxyXG4gICAgLnNvcnQoKGEsIGIpID0+IGJbMV0gLSBhWzFdKVxyXG4gICAgLm1hcCgoW3dvcmQsIGNvdW50XSkgPT4gKHsgd29yZCwgY291bnQgfSkpO1xyXG59Il0sIm5hbWVzIjpbIk5leHRSZXNwb25zZSIsInN1cGFiYXNlU2VydmVyIiwiR0VUIiwicmVxdWVzdCIsInBhcmFtcyIsInN1cGFiYXNlIiwiZGF0YSIsInVzZXIiLCJlcnJvciIsImF1dGhFcnJvciIsImF1dGgiLCJnZXRVc2VyIiwianNvbiIsInN0YXR1cyIsInN1cnZleSIsInN1cnZleUVycm9yIiwiZnJvbSIsInNlbGVjdCIsImVxIiwiaWQiLCJzaW5nbGUiLCJjb3VudCIsInRvdGFsUmVzcG9uc2VzIiwiY291bnRFcnJvciIsImhlYWQiLCJjb25zb2xlIiwicXVlc3Rpb25zIiwicXVlc3Rpb25zRXJyb3IiLCJvcmRlciIsImFzY2VuZGluZyIsInJlc3BvbnNlcyIsInJlc3BvbnNlc0Vycm9yIiwicXVlc3Rpb25zV2l0aEFuYWx5dGljcyIsInByb2Nlc3NRdWVzdGlvbnNBbmFseXRpY3MiLCJkZXZpY2VTdGF0cyIsImNhbGN1bGF0ZURldmljZVN0YXRzIiwicmVzcG9uc2VUcmVuZCIsImNhbGN1bGF0ZVJlc3BvbnNlVHJlbmQiLCJyZXN1bHQiLCJzdWNjZXNzIiwidGl0bGUiLCJkZXNjcmlwdGlvbiIsImNyZWF0ZWRfYXQiLCJwdWJsaXNoZWRfYXQiLCJwdWJsaXNoX2F0IiwidG90YWxfcmVzcG9uc2VzIiwic3VtbWFyeSIsImNvbXBsZXRpb25fcmF0ZSIsImNhbGN1bGF0ZUNvbXBsZXRpb25SYXRlIiwibGVuZ3RoIiwiYXZnX3Jlc3BvbnNlX3RpbWUiLCJjYWxjdWxhdGVBdmVyYWdlUmVzcG9uc2VUaW1lIiwiZGV2aWNlX3N0YXRzIiwicmVzcG9uc2VfdHJlbmQiLCJyYXdfcmVzcG9uc2VzX2NvdW50IiwiZGV0YWlscyIsIkVycm9yIiwibWVzc2FnZSIsIlByb21pc2UiLCJhbGwiLCJtYXAiLCJxdWVzdGlvbiIsInF1ZXN0aW9uUmVzcG9uc2VzIiwiZmxhdE1hcCIsInIiLCJyZXNwb25zZV9pdGVtcyIsImZpbHRlciIsInJpIiwicXVlc3Rpb25faWQiLCJhbmFseXRpY3NEYXRhIiwidHlwZSIsInByb2Nlc3NTaW5nbGVDaG9pY2VBbmFseXRpY3MiLCJwcm9jZXNzTXVsdGlwbGVDaG9pY2VBbmFseXRpY3MiLCJwcm9jZXNzTGlrZXJ0QW5hbHl0aWNzIiwicHJvY2Vzc1RleHRBbmFseXRpY3MiLCJ1bnN1cHBvcnRlZCIsInF1ZXN0aW9uX3RleHQiLCJyZXF1aXJlZCIsInBvc2l0aW9uIiwicmVzcG9uc2VfY291bnQiLCJhbmFseXRpY3MiLCJvcHRpb25zIiwic3VydmV5X29wdGlvbnMiLCJvcHRpb25Db3VudHMiLCJmb3JFYWNoIiwib3B0IiwibGFiZWwiLCJ2YWx1ZSIsInJlc3BvbnNlIiwidmFsdWVfdGV4dCIsInRvdGFsIiwiY2hhcnREYXRhIiwiT2JqZWN0IiwiZW50cmllcyIsIm9wdGlvbiIsInBlcmNlbnRhZ2UiLCJwYXJzZUZsb2F0IiwidG9GaXhlZCIsImNoYXJ0X2RhdGEiLCJtb3N0X3NlbGVjdGVkIiwicmVkdWNlIiwibWF4IiwiaXRlbSIsInRvdGFsU2VsZWN0aW9ucyIsInZhbHVlX2pzb24iLCJBcnJheSIsImlzQXJyYXkiLCJ1bmRlZmluZWQiLCJzZWxlY3Rpb25fcGVyY2VudGFnZSIsInJlc3BvbmRlbnRfcGVyY2VudGFnZSIsInRvdGFsX3NlbGVjdGlvbnMiLCJhdmdfc2VsZWN0aW9uc19wZXJfcmVzcG9uc2UiLCJyYXRpbmdDb3VudHMiLCJyYXRpbmdzIiwicmF0aW5nIiwic3VtIiwidmFsdWVfbnVtZXJpYyIsIk51bWJlciIsImluY2x1ZGVzIiwiYXZlcmFnZV9yYXRpbmciLCJtZWRpYW5fcmF0aW5nIiwiY2FsY3VsYXRlTWVkaWFuIiwiZGlzdHJpYnV0aW9uIiwidGV4dFJlc3BvbnNlcyIsInRyaW0iLCJ0ZXh0Iiwid29yZF9jb3VudCIsInNwbGl0IiwidyIsIndvcmRGcmVxdWVuY2llcyIsImFuYWx5emVXb3JkRnJlcXVlbmN5IiwiYXZnTGVuZ3RoIiwiYXZnV29yZENvdW50Iiwic2FtcGxlX3Jlc3BvbnNlcyIsInNsaWNlIiwid29yZF9mcmVxdWVuY2llcyIsImF2ZXJhZ2VfbGVuZ3RoIiwiTWF0aCIsInJvdW5kIiwiYXZlcmFnZV93b3JkX2NvdW50Iiwic2hvcnRlc3RfcmVzcG9uc2UiLCJtaW4iLCJsb25nZXN0X3Jlc3BvbnNlIiwic3RhdHMiLCJtb2JpbGUiLCJkZXNrdG9wIiwidGFibGV0IiwiYnJvd3NlcnMiLCJvcGVyYXRpbmdfc3lzdGVtcyIsIm1ldGEiLCJpc19tb2JpbGUiLCJpc190YWJsZXQiLCJicm93c2VyIiwib3MiLCJtb2JpbGVfcGVyY2VudGFnZSIsImRlc2t0b3BfcGVyY2VudGFnZSIsInRhYmxldF9wZXJjZW50YWdlIiwidG9wX2Jyb3dzZXIiLCJzb3J0IiwiYSIsImIiLCJ0b3Bfb3MiLCJzdXJ2ZXlJZCIsInNldmVuRGF5c0FnbyIsIkRhdGUiLCJzZXREYXRlIiwiZ2V0RGF0ZSIsImRhaWx5UmVzcG9uc2VzIiwiZ3RlIiwidG9JU09TdHJpbmciLCJkYWlseUNvdW50cyIsImRhdGUiLCJzdWJtaXR0ZWRfYXQiLCJ0cmVuZERhdGEiLCJpIiwiZGF0ZVN0ciIsInB1c2giLCJ0b3RhbFF1ZXN0aW9ucyIsInRvdGFsQW5zd2VyZWQiLCJhbnN3ZXJlZCIsImVzdGltYXRlZFRpbWVQZXJRdWVzdGlvbiIsImF2Z1F1ZXN0aW9uc0Fuc3dlcmVkIiwiYXZnU2Vjb25kcyIsIm1pbnV0ZXMiLCJmbG9vciIsIm1pZGRsZSIsInRleHRzIiwid29yZE1hcCIsInN0b3BXb3JkcyIsIlNldCIsIndvcmRzIiwidG9Mb3dlckNhc2UiLCJyZXBsYWNlIiwid29yZCIsImhhcyJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./app/api/surveys/[id]/analytics/route.ts\n");

/***/ }),

/***/ "(rsc)/./lib/supabaseServer.ts":
/*!*******************************!*\
  !*** ./lib/supabaseServer.ts ***!
  \*******************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   supabaseServer: () => (/* binding */ supabaseServer)\n/* harmony export */ });\n/* harmony import */ var next_headers__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/headers */ \"(rsc)/./node_modules/next/dist/api/headers.js\");\n/* harmony import */ var _supabase_ssr__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @supabase/ssr */ \"(rsc)/./node_modules/@supabase/ssr/dist/module/index.js\");\n// lib/supabaseServer.ts\n\n\nfunction supabaseServer() {\n    const cookieStore = (0,next_headers__WEBPACK_IMPORTED_MODULE_0__.cookies)();\n    return (0,_supabase_ssr__WEBPACK_IMPORTED_MODULE_1__.createServerClient)(\"https://jfagkzxzkbslpohhojuh.supabase.co\", \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImpmYWdrenh6a2JzbHBvaGhvanVoIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjI0NDIyNjQsImV4cCI6MjA3ODAxODI2NH0.y8rKE8CyNK54GkqRRDalX5hyPy1YrG8NVj6mr2sgKPU\", {\n        cookies: {\n            getAll () {\n                return cookieStore.getAll();\n            },\n            setAll (cookiesToSet) {\n                try {\n                    cookiesToSet.forEach(({ name, value, options })=>{\n                        cookieStore.set(name, value, options);\n                    });\n                } catch  {\n                // Esto puede fallar en middleware\n                }\n            }\n        }\n    });\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9saWIvc3VwYWJhc2VTZXJ2ZXIudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQUEsd0JBQXdCO0FBQ2U7QUFDZ0M7QUFFaEUsU0FBU0U7SUFDZCxNQUFNQyxjQUFjSCxxREFBT0E7SUFFM0IsT0FBT0MsaUVBQWtCQSxDQUN2QkcsMENBQW9DLEVBQ3BDQSxrTkFBeUMsRUFDekM7UUFDRUosU0FBUztZQUNQUTtnQkFDRSxPQUFPTCxZQUFZSyxNQUFNO1lBQzNCO1lBQ0FDLFFBQU9DLFlBQXVFO2dCQUM1RSxJQUFJO29CQUNGQSxhQUFhQyxPQUFPLENBQUMsQ0FBQyxFQUFFQyxJQUFJLEVBQUVDLEtBQUssRUFBRUMsT0FBTyxFQUFFO3dCQUM1Q1gsWUFBWVksR0FBRyxDQUFDSCxNQUFNQyxPQUFPQztvQkFDL0I7Z0JBQ0YsRUFBRSxPQUFNO2dCQUNOLGtDQUFrQztnQkFDcEM7WUFDRjtRQUNGO0lBQ0Y7QUFFSiIsInNvdXJjZXMiOlsid2VicGFjazovL2VuY3Vlc3Rhcy1xci8uL2xpYi9zdXBhYmFzZVNlcnZlci50cz9jNzhjIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIGxpYi9zdXBhYmFzZVNlcnZlci50c1xyXG5pbXBvcnQgeyBjb29raWVzIH0gZnJvbSBcIm5leHQvaGVhZGVyc1wiO1xyXG5pbXBvcnQgeyBjcmVhdGVTZXJ2ZXJDbGllbnQsIHR5cGUgQ29va2llT3B0aW9ucyB9IGZyb20gXCJAc3VwYWJhc2Uvc3NyXCI7XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gc3VwYWJhc2VTZXJ2ZXIoKSB7XHJcbiAgY29uc3QgY29va2llU3RvcmUgPSBjb29raWVzKCk7XHJcblxyXG4gIHJldHVybiBjcmVhdGVTZXJ2ZXJDbGllbnQoXHJcbiAgICBwcm9jZXNzLmVudi5ORVhUX1BVQkxJQ19TVVBBQkFTRV9VUkwhLFxyXG4gICAgcHJvY2Vzcy5lbnYuTkVYVF9QVUJMSUNfU1VQQUJBU0VfQU5PTl9LRVkhLFxyXG4gICAge1xyXG4gICAgICBjb29raWVzOiB7XHJcbiAgICAgICAgZ2V0QWxsKCkge1xyXG4gICAgICAgICAgcmV0dXJuIGNvb2tpZVN0b3JlLmdldEFsbCgpO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgc2V0QWxsKGNvb2tpZXNUb1NldDogeyBuYW1lOiBzdHJpbmc7IHZhbHVlOiBzdHJpbmc7IG9wdGlvbnM6IENvb2tpZU9wdGlvbnMgfVtdKSB7XHJcbiAgICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICBjb29raWVzVG9TZXQuZm9yRWFjaCgoeyBuYW1lLCB2YWx1ZSwgb3B0aW9ucyB9KSA9PiB7XHJcbiAgICAgICAgICAgICAgY29va2llU3RvcmUuc2V0KG5hbWUsIHZhbHVlLCBvcHRpb25zKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICB9IGNhdGNoIHtcclxuICAgICAgICAgICAgLy8gRXN0byBwdWVkZSBmYWxsYXIgZW4gbWlkZGxld2FyZVxyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH0sXHJcbiAgICAgIH0sXHJcbiAgICB9XHJcbiAgKTtcclxufSJdLCJuYW1lcyI6WyJjb29raWVzIiwiY3JlYXRlU2VydmVyQ2xpZW50Iiwic3VwYWJhc2VTZXJ2ZXIiLCJjb29raWVTdG9yZSIsInByb2Nlc3MiLCJlbnYiLCJORVhUX1BVQkxJQ19TVVBBQkFTRV9VUkwiLCJORVhUX1BVQkxJQ19TVVBBQkFTRV9BTk9OX0tFWSIsImdldEFsbCIsInNldEFsbCIsImNvb2tpZXNUb1NldCIsImZvckVhY2giLCJuYW1lIiwidmFsdWUiLCJvcHRpb25zIiwic2V0Il0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./lib/supabaseServer.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next","vendor-chunks/@supabase","vendor-chunks/tr46","vendor-chunks/whatwg-url","vendor-chunks/cookie","vendor-chunks/webidl-conversions"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fsurveys%2F%5Bid%5D%2Fanalytics%2Froute&page=%2Fapi%2Fsurveys%2F%5Bid%5D%2Fanalytics%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fsurveys%2F%5Bid%5D%2Fanalytics%2Froute.ts&appDir=C%3A%5CProjects%5CMM100922-DevOps-QR%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CProjects%5CMM100922-DevOps-QR&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();