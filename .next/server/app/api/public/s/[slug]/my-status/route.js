"use strict";(()=>{var e={};e.id=535,e.ids=[535],e.modules={72934:e=>{e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},14300:e=>{e.exports=require("buffer")},6113:e=>{e.exports=require("crypto")},82361:e=>{e.exports=require("events")},13685:e=>{e.exports=require("http")},95687:e=>{e.exports=require("https")},41808:e=>{e.exports=require("net")},85477:e=>{e.exports=require("punycode")},12781:e=>{e.exports=require("stream")},24404:e=>{e.exports=require("tls")},57310:e=>{e.exports=require("url")},59796:e=>{e.exports=require("zlib")},62783:(e,s,r)=>{r.r(s),r.d(s,{originalPathname:()=>m,patchFetch:()=>x,requestAsyncStorage:()=>c,routeModule:()=>l,serverHooks:()=>g,staticGenerationAsyncStorage:()=>d});var t={};r.r(t),r.d(t,{GET:()=>u});var i=r(49303),o=r(88716),n=r(60670),a=r(87070),p=r(30474);async function u(e,{params:s}){let r=(0,p.R)(),t=new URL(e.url),i=t.searchParams.get("token")??"",o=t.searchParams.get("fp")??"",{data:{user:n}}=await r.auth.getUser(),{data:u,error:l}=await r.from("surveys").select("id, status, single_response, single_response_scope").eq("slug",s.slug).single();if(l||!u)return a.NextResponse.json({error:"Survey not found"},{status:404});if("published"!==u.status)return a.NextResponse.json({error:"Survey not available"},{status:410});let c=!1,d=!1;if(u.single_response){if("user"===u.single_response_scope){if(n){let{data:e}=await r.from("responses").select("id").eq("survey_id",u.id).eq("user_id",n.id).maybeSingle();c=!!e}}else if(i||o){if(i){let{data:e}=await r.from("responses").select("id").eq("survey_id",u.id).eq("respondent_token",i).maybeSingle();e&&(c=!0)}if(!c&&o){let{data:e}=await r.from("responses").select("id").eq("survey_id",u.id).eq("respondent_fp",o).maybeSingle();e&&(c=!0)}}else d=!0}return a.NextResponse.json({singleResponse:u.single_response,scope:u.single_response_scope,alreadyResponded:c,requiresLogin:u.single_response&&"user"===u.single_response_scope&&!n,requiresTokenOrFp:d,message:d?"Se requiere token o fingerprint del dispositivo para verificar respuestas \xfanicas":void 0})}let l=new i.AppRouteRouteModule({definition:{kind:o.x.APP_ROUTE,page:"/api/public/s/[slug]/my-status/route",pathname:"/api/public/s/[slug]/my-status",filename:"route",bundlePath:"app/api/public/s/[slug]/my-status/route"},resolvedPagePath:"C:\\Projects\\MM100922-DevOps-QR\\app\\api\\public\\s\\[slug]\\my-status\\route.ts",nextConfigOutput:"",userland:t}),{requestAsyncStorage:c,staticGenerationAsyncStorage:d,serverHooks:g}=l,m="/api/public/s/[slug]/my-status/route";function x(){return(0,n.patchFetch)({serverHooks:g,staticGenerationAsyncStorage:d})}},30474:(e,s,r)=>{r.d(s,{R:()=>o});var t=r(71615),i=r(16510);function o(){let e=(0,t.cookies)();return(0,i.createServerClient)("https://jfagkzxzkbslpohhojuh.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImpmYWdrenh6a2JzbHBvaGhvanVoIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjI0NDIyNjQsImV4cCI6MjA3ODAxODI2NH0.y8rKE8CyNK54GkqRRDalX5hyPy1YrG8NVj6mr2sgKPU",{cookies:{getAll:()=>e.getAll(),setAll(s){try{s.forEach(({name:s,value:r,options:t})=>{e.set(s,r,t)})}catch{}}}})}}};var s=require("../../../../../../webpack-runtime.js");s.C(e);var r=e=>s(s.s=e),t=s.X(0,[948,223,972],()=>r(62783));module.exports=t})();