(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[185],{24915:function(e,n,a){Promise.resolve().then(a.t.bind(a,58877,23)),Promise.resolve().then(a.bind(a,33228)),Promise.resolve().then(a.bind(a,81030)),Promise.resolve().then(a.bind(a,88726))},33228:function(e,n,a){"use strict";a.d(n,{default:function(){return o}});var s=a(57437),r=a(87138),i=a(88726),t=a(2265),l=a(62100),u=a(16463);function o(){let[e,n]=(0,t.useState)(null);if((0,t.useEffect)(()=>{n((0,l.V)())},[]),!e)return null;let a=(0,u.useRouter)();(0,u.usePathname)();let[o,d]=(0,t.useState)(!1),{user:c,loading:m}=function(){let[e,n]=(0,t.useState)(null),[a,s]=(0,t.useState)(!0);return(0,t.useEffect)(()=>{let e=(0,l.V)();if(!e){s(!1);return}let a=!0;(async function(){var r,i,t,l,u,o,d;let{data:{user:c}}=await e.auth.getUser();if(!a)return;if(!c){n(null),s(!1);return}let m=null!==(d=null!==(o=null!==(u=null!==(l=null===(r=c.user_metadata)||void 0===r?void 0:r.display_name)&&void 0!==l?l:null===(i=c.user_metadata)||void 0===i?void 0:i.full_name)&&void 0!==u?u:null===(t=c.user_metadata)||void 0===t?void 0:t.name)&&void 0!==o?o:c.email)&&void 0!==d?d:"Usuario";try{let{data:n}=await e.from("profiles").select("display_name").eq("id",c.id).maybeSingle();(null==n?void 0:n.display_name)&&(m=n.display_name)}catch(e){console.warn("Could not fetch profile:",e)}n({id:c.id,email:c.email,name:m}),s(!1)})();let{data:{subscription:r}}=e.auth.onAuthStateChange((e,r)=>{var i,t,l,u,o;if(!a)return;if(!(null==r?void 0:r.user)){n(null),s(!1);return}let d=r.user,c=null!==(i=d.user_metadata)&&void 0!==i?i:{},m=null!==(o=null!==(u=null!==(l=null!==(t=c.display_name)&&void 0!==t?t:c.full_name)&&void 0!==l?l:c.name)&&void 0!==u?u:d.email)&&void 0!==o?o:"Usuario";n({id:d.id,email:d.email,name:m}),s(!1)});return()=>{a=!1,r.unsubscribe()}},[]),{user:e,loading:a}}(),h=async()=>{try{await e.auth.signOut(),i.ZP.success("Sesi\xf3n cerrada"),a.refresh(),a.push("/")}catch(e){console.error("Error en logout:",e),i.ZP.error("No se pudo cerrar sesi\xf3n")}},f=()=>{d(!1)};return(0,s.jsxs)("nav",{className:"nav",children:[(0,s.jsxs)("div",{className:"nav-inner container",children:[(0,s.jsxs)(r.default,{href:"/",className:"brand",onClick:f,children:["Surveys\xa0",(0,s.jsx)("span",{className:"badge",children:"UFG"})]}),(0,s.jsx)("button",{className:"sm:hidden btn","aria-controls":"mobile-menu","aria-expanded":o,onClick:()=>d(e=>!e),children:(0,s.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})}),(0,s.jsx)("div",{className:"hidden sm:flex items-center gap-3",children:m?(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)("div",{className:"h-4 w-24 bg-gray-200 rounded animate-pulse"}),(0,s.jsx)("div",{className:"h-4 w-20 bg-gray-200 rounded animate-pulse"})]}):(0,s.jsxs)(s.Fragment,{children:[c&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(r.default,{href:"/surveys",onClick:f,children:"Mis encuestas"}),(0,s.jsx)(r.default,{href:"/analytics",onClick:f,children:"Anal\xedtica"})]}),c?(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(r.default,{href:"/profile",className:"btn outline",title:"Ver/editar perfil",onClick:f,children:c.name}),(0,s.jsx)("button",{className:"btn",onClick:h,children:"Cerrar Sesi\xf3n"})]}):(0,s.jsx)(r.default,{href:"/auth/login",className:"btn primary",onClick:f,children:"Iniciar Sesi\xf3n"})]})})]}),(0,s.jsx)("div",{id:"mobile-menu",className:"sm:hidden ".concat(o?"block":"hidden"," border-t border-[rgba(125,117,116,0.15)] bg-[rgba(250,245,233,0.95)]"),children:(0,s.jsx)("div",{className:"container py-2 space-y-1",children:m?(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("div",{className:"h-8 bg-gray-200 rounded animate-pulse"}),(0,s.jsx)("div",{className:"h-8 bg-gray-200 rounded animate-pulse"}),(0,s.jsx)("div",{className:"h-10 bg-gray-200 rounded animate-pulse"})]}):(0,s.jsxs)(s.Fragment,{children:[c&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(r.default,{href:"/surveys",className:"block px-2 py-2 rounded-md hover:bg-white",onClick:f,children:"Mis encuestas"}),(0,s.jsx)(r.default,{href:"/analytics",className:"block px-2 py-2 rounded-md hover:bg-white",onClick:f,children:"Anal\xedtica"}),(0,s.jsx)(r.default,{href:"/profile",className:"block px-2 py-2 rounded-md hover:bg-white",onClick:f,children:c.name}),(0,s.jsx)("button",{onClick:h,className:"block w-full text-center px-2 py-2 rounded-md btn",children:"Cerrar Sesi\xf3n"})]}),!c&&(0,s.jsx)(r.default,{href:"/auth/login",className:"block px-2 py-2 rounded-md btn primary w-full text-center",onClick:f,children:"Iniciar Sesi\xf3n"})]})})})]})}},81030:function(e,n,a){"use strict";a.d(n,{default:function(){return i}});var s=a(2265),r=a(62100);function i(){let[e,n]=(0,s.useState)(null);return(0,s.useEffect)(()=>{n((0,r.V)())},[]),e&&(0,s.useEffect)(()=>{let e=async()=>{try{let e=(0,r.V)(),{data:{session:n}}=await e.auth.getSession();n&&console.log("Session initialized:",n.user.email)}catch(e){console.error("Error initializing session:",e)}},n=n=>{var a;(null===(a=n.key)||void 0===a?void 0:a.includes("supabase.auth.token"))&&e()};return e(),window.addEventListener("storage",n),()=>{window.removeEventListener("storage",n)}},[]),null}},62100:function(e,n,a){"use strict";a.d(n,{V:function(){return i}});var s=a(35570);let r=null;function i(){return r||(r=(0,s.createBrowserClient)("https://jfagkzxzkbslpohhojuh.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImpmYWdrenh6a2JzbHBvaGhvanVoIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjI0NDIyNjQsImV4cCI6MjA3ODAxODI2NH0.y8rKE8CyNK54GkqRRDalX5hyPy1YrG8NVj6mr2sgKPU",{auth:{persistSession:!0,autoRefreshToken:!0,detectSessionInUrl:!1}}))}},87138:function(e,n,a){"use strict";a.d(n,{default:function(){return r.a}});var s=a(231),r=a.n(s)},16463:function(e,n,a){"use strict";var s=a(71169);a.o(s,"useParams")&&a.d(n,{useParams:function(){return s.useParams}}),a.o(s,"usePathname")&&a.d(n,{usePathname:function(){return s.usePathname}}),a.o(s,"useRouter")&&a.d(n,{useRouter:function(){return s.useRouter}})},58877:function(){}},function(e){e.O(0,[404,570,726,231,971,23,744],function(){return e(e.s=24915)}),_N_E=e.O()}]);