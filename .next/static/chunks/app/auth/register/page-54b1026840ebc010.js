(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[454],{56771:function(e,r,n){Promise.resolve().then(n.bind(n,24400))},24400:function(e,r,n){"use strict";n.r(r),n.d(r,{default:function(){return c}});var a=n(57437),s=n(87138),t=n(88726),i=n(16463),o=n(2265),l=n(62100);function c(){let e=(0,i.useRouter)(),[r,n]=(0,o.useState)(null);if((0,o.useEffect)(()=>{n((0,l.V)())},[]),!r)return null;(0,o.useEffect)(()=>{(async()=>{let{data:{user:n}}=await r.auth.getUser();n&&e.replace("/surveys")})()},[e,r]);let[c,u]=(0,o.useState)({email:"",password:"",repeatPassword:"",nombres:"",apellidos:"",telefono:"",genero:"",fechaNacimiento:""}),[d,m]=(0,o.useState)(!1),[h,p]=(0,o.useState)(0);(0,o.useEffect)(()=>{let e=Number(localStorage.getItem("signup_cooldown_until")||0),r=Math.floor(Date.now()/1e3);e>r&&p(e-r)},[]),(0,o.useEffect)(()=>{if(h<=0)return;let e=setInterval(()=>p(e=>e-1),1e3);return()=>clearInterval(e)},[h]);let f=()=>{let e=Math.floor(Date.now()/1e3)+60;localStorage.setItem("signup_cooldown_until",String(e)),p(60)},g=e=>u(r=>({...r,[e.target.name]:e.target.value})),v=async e=>{if(e.preventDefault(),h>0)return t.ZP.error("Espera ".concat(h,"s para intentarlo de nuevo"));if(!c.email||!c.password)return t.ZP.error("Completa email y contrase\xf1a");if(c.password.length<8)return t.ZP.error("La contrase\xf1a debe tener al menos 8 caracteres");if(c.password!==c.repeatPassword)return t.ZP.error("Las contrase\xf1as no coinciden");if(!c.nombres||!c.apellidos)return t.ZP.error("Completa nombres y apellidos");if(!c.genero)return t.ZP.error("Selecciona el g\xe9nero");if(!c.fechaNacimiento)return t.ZP.error("Indica tu fecha de nacimiento");m(!0);let{error:n}=await r.auth.signUp({email:c.email,password:c.password,options:{emailRedirectTo:"".concat(location.origin,"/surveys"),data:{display_name:"".concat(c.nombres," ").concat(c.apellidos).trim(),nombres:c.nombres,apellidos:c.apellidos,telefono:c.telefono,genero:c.genero,fecha_nacimiento:c.fechaNacimiento}}});if(m(!1),n)return 429===n.status?(f(),t.ZP.error("Demasiadas solicitudes. Intenta en 60s.")):t.ZP.error(n.message);f(),t.ZP.success("Cuenta creada. Revisa tu correo para verificarla.")},j=async()=>{if(!c.email)return t.ZP.error("Ingresa tu correo para reenviar");if(h>0)return t.ZP.error("Reenviar en ".concat(h,"s"));m(!0);let{error:e}=await r.auth.resend({type:"signup",email:c.email,options:{emailRedirectTo:"".concat(location.origin,"/surveys")}});if(m(!1),e)return 429===e.status?(f(),t.ZP.error("Demasiadas solicitudes. Intenta en 60s.")):t.ZP.error(e.message);f(),t.ZP.success("Verificaci\xf3n reenviada. Revisa tu bandeja y spam.")};return(0,a.jsx)("main",{style:{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center",background:"var(--bg)",padding:"1rem"},children:(0,a.jsxs)("div",{className:"card",style:{width:"100%",maxWidth:500,textAlign:"center"},children:[(0,a.jsx)("h1",{style:{marginTop:0,marginBottom:"1rem"},children:"Crear cuenta"}),(0,a.jsxs)("form",{onSubmit:v,className:"grid",style:{gap:"1rem",textAlign:"left"},children:[(0,a.jsxs)("div",{className:"grid grid-2",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{children:"Nombres"}),(0,a.jsx)("input",{name:"nombres",value:c.nombres,onChange:g,required:!0})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{children:"Apellidos"}),(0,a.jsx)("input",{name:"apellidos",value:c.apellidos,onChange:g,required:!0})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{children:"Correo electr\xf3nico"}),(0,a.jsx)("input",{name:"email",type:"email",value:c.email,onChange:g,required:!0})]}),(0,a.jsxs)("div",{className:"grid grid-2",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{children:"Contrase\xf1a"}),(0,a.jsx)("input",{name:"password",type:"password",value:c.password,onChange:g,required:!0})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{children:"Repetir contrase\xf1a"}),(0,a.jsx)("input",{name:"repeatPassword",type:"password",value:c.repeatPassword,onChange:g,required:!0})]})]}),(0,a.jsxs)("div",{className:"grid grid-2",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{children:"N\xfamero de tel\xe9fono"}),(0,a.jsx)("input",{name:"telefono",type:"tel",placeholder:"Ej. +503 7777 7777",value:c.telefono,onChange:g})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{children:"G\xe9nero"}),(0,a.jsxs)("select",{name:"genero",value:c.genero,onChange:g,required:!0,children:[(0,a.jsx)("option",{value:"",children:"Seleccione..."}),(0,a.jsx)("option",{value:"Masculino",children:"Masculino"}),(0,a.jsx)("option",{value:"Femenino",children:"Femenino"}),(0,a.jsx)("option",{value:"Otro",children:"Otro"})]})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{children:"Fecha de nacimiento"}),(0,a.jsx)("input",{name:"fechaNacimiento",type:"date",value:c.fechaNacimiento,onChange:g,required:!0})]}),(0,a.jsx)("button",{className:"btn primary",type:"submit",disabled:d||h>0,children:h>0?"Espera ".concat(h,"s"):d?"Registrando...":"Registrarme"})]}),(0,a.jsx)("div",{className:"stack",style:{justifyContent:"center",marginTop:".7rem"},children:(0,a.jsx)("button",{className:"btn outline",onClick:j,disabled:d||h>0,children:h>0?"Reenviar en ".concat(h,"s"):"Reenviar verificaci\xf3n"})}),(0,a.jsxs)("p",{style:{marginTop:"1.2rem",fontSize:".9rem",color:"var(--muted)"},children:["\xbfYa tienes cuenta?"," ",(0,a.jsx)(s.default,{href:"/auth/login",style:{color:"var(--accent)",fontWeight:600},children:"Inicia sesi\xf3n"})]})]})})}},62100:function(e,r,n){"use strict";n.d(r,{V:function(){return t}});var a=n(35570);let s=null;function t(){return s||(s=(0,a.createBrowserClient)("https://jfagkzxzkbslpohhojuh.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImpmYWdrenh6a2JzbHBvaGhvanVoIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjI0NDIyNjQsImV4cCI6MjA3ODAxODI2NH0.y8rKE8CyNK54GkqRRDalX5hyPy1YrG8NVj6mr2sgKPU",{auth:{persistSession:!0,autoRefreshToken:!0,detectSessionInUrl:!1}}))}},87138:function(e,r,n){"use strict";n.d(r,{default:function(){return s.a}});var a=n(231),s=n.n(a)},16463:function(e,r,n){"use strict";var a=n(71169);n.o(a,"useParams")&&n.d(r,{useParams:function(){return a.useParams}}),n.o(a,"usePathname")&&n.d(r,{usePathname:function(){return a.usePathname}}),n.o(a,"useRouter")&&n.d(r,{useRouter:function(){return a.useRouter}})}},function(e){e.O(0,[570,726,231,971,23,744],function(){return e(e.s=56771)}),_N_E=e.O()}]);