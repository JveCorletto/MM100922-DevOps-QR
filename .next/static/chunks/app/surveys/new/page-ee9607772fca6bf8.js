(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[126],{24019:function(e,t,r){Promise.resolve().then(r.bind(r,37721))},37721:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return o}});var i=r(57437),s=r(39343),n=r(2265),a=r(16463),c=r(88726),l=r(62100);function o(){let{register:e,handleSubmit:t,reset:r}=(0,s.cI)(),[o,u]=(0,n.useState)(!1),d=(0,a.useRouter)(),[h,p]=(0,n.useState)(null);if((0,n.useEffect)(()=>{p((0,l.V)())},[]),!h)return null;(0,n.useEffect)(()=>{(async()=>{let{data:{user:e}}=await h.auth.getUser();e||d.replace("/auth/login")})()},[d,h]);let f=async e=>{var t,i,s;if(!o){if(!(null===(t=e.title)||void 0===t?void 0:t.trim()))return c.ZP.error("El t\xedtulo es requerido");u(!0);try{let t=await fetch("/api/surveys",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({title:e.title.trim(),description:(null===(i=e.description)||void 0===i?void 0:i.trim())||""})});if(!t.ok){let e=await t.json().catch(()=>({}));throw Error(e.error||"Error al crear encuesta")}let s=await t.json();c.ZP.success("Encuesta creada"),r(),d.replace("/surveys/".concat(s.id,"/edit"))}catch(e){c.ZP.error(null!==(s=e.message)&&void 0!==s?s:"No se pudo crear")}finally{u(!1)}}};return(0,i.jsx)("main",{className:"container section",children:(0,i.jsxs)("div",{className:"card",children:[(0,i.jsx)("h1",{style:{marginTop:0},children:"Nueva encuesta"}),(0,i.jsxs)("form",{onSubmit:t(f),className:"grid",style:{gap:"1rem"},children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{children:"T\xedtulo"}),(0,i.jsx)("input",{...e("title",{required:!0}),placeholder:"Satisfacci\xf3n del servicio"})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{children:"Descripci\xf3n"}),(0,i.jsx)("textarea",{...e("description"),placeholder:"Opcional",rows:4})]}),(0,i.jsx)("button",{className:"btn primary",disabled:o,type:"submit",children:o?"Creando...":"Crear"})]})]})})}},62100:function(e,t,r){"use strict";r.d(t,{V:function(){return n}});var i=r(35570);let s=null;function n(){return s||(s=(0,i.createBrowserClient)("https://jfagkzxzkbslpohhojuh.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImpmYWdrenh6a2JzbHBvaGhvanVoIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjI0NDIyNjQsImV4cCI6MjA3ODAxODI2NH0.y8rKE8CyNK54GkqRRDalX5hyPy1YrG8NVj6mr2sgKPU",{auth:{persistSession:!0,autoRefreshToken:!0,detectSessionInUrl:!1}}))}}},function(e){e.O(0,[570,726,527,971,23,744],function(){return e(e.s=24019)}),_N_E=e.O()}]);